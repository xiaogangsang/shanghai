{"version":3,"sources":["webpack:///webpack/bootstrap af1d8375293f3aac4b39?629b******","webpack:///./src/js/activity-unit-edit.js","webpack:///./src/common/common.js?17e8******","webpack:///./bower_components/js-cookie/src/js.cookie.js?76a1******","webpack:///./bower_components/js-cookie/src/js.cookie.js?99a4******"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA,aAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,aAAa;AACd,EAAC,aAAa;AACd;AACA;AACA,EAAC,aAAa;AACd,EAAC,eAAe;AAChB,EAAC,eAAe;AAChB,EAAC,aAAa;AACd;AACA;AACA,EAAC,aAAa;AACd,EAAC,aAAa;AACd,EAAC,aAAa;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA,EAAC;;AAED;AACA;AACA;AACA;AACA,sFAAqF,iBAAiB;AACtG;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oHAAmH,EAAE;AACrH,oHAAmH,EAAE;AACrH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA,aAAY;AACZ,IAAG;AACH;AACA,4CAA2C,OAAO;AAClD,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C,6FAA6F;AACzI;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA,qFAAoF,wBAAwB;AAC5G;AACA;AACA,IAAG;AACH,0EAAyE,oCAAoC;AAC7G;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA,iFAAgF,wBAAwB;AACxG,qIAAoI,oCAAoC;AACxK;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,0EAAyE,wBAAwB;AACjG,gEAA+D,mDAAmD;AAClH,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iFAAgF,oCAAoC;AACpH;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA,qFAAoF,oCAAoC;AACxH;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA,iFAAgF,oCAAoC;AACpH;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,wCAAuC,oCAAoC;AAC3E;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;;AAEP;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH,EAAC;;AAED;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA,qBAAoB,mCAAmC;AACvD,wCAAuC,+GAA+G;AACtJ,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAmC;AACnC;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,UAAS;;AAET;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;;AAET;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,iEAAiE;AAC5E,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;;AAEP;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,0CAA0C;AACrD,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;;AAET;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;;AAET;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gDAA+C,wBAAwB;;AAEvE;AACA,MAAK;AACL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,QAAO;;AAEP;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,YAAW;AACX;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,yDAAwD,EAAE,MAAM,EAAE,IAAI,IAAI,SAAS,EAAE,YAAY,EAAE,IAAI,IAAI;AAC3G;AACA;AACA;AACA,yDAAwD,EAAE;AAC1D;AACA;AACA;AACA,yDAAwD,EAAE;AAC1D;AACA;AACA;AACA,yDAAwD,EAAE,MAAM,EAAE,IAAI,IAAI,SAAS,EAAE,YAAY,EAAE,IAAI,IAAI;AAC3G;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,aAAa;AACxB,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,8BAA8B;AAC/C,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,YAAW;AACX;AACA;AACA,UAAS;AACT;;AAEA;;AAEA;AACA,sCAAqC;AACrC,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;;AAEA;;AAEA,6CAA4C,iCAAiC;AAC7E;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+GAA8G,EAAE,MAAM,EAAE,IAAI,IAAI,SAAS,EAAE,YAAY,EAAE,IAAI,IAAI;AACjK,wHAAuH,EAAE,MAAM,EAAE,IAAI,IAAI,SAAS,EAAE,YAAY,EAAE,IAAI,IAAI;AAC1K,wHAAuH,EAAE,MAAM,EAAE,IAAI,IAAI,SAAS,EAAE,YAAY,EAAE,IAAI,IAAI;AAC1K;AACA;AACA,QAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;;;;;;;ACj/CA,aAAY;;AAEZ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yPAAwP;AACxP;AACA,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;ACzHA,2G;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,GAAE;AACF;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA,SAAQ,sBAAsB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAc;AACd;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,8BAA6B;AAC7B,8BAA6B;AAC7B,8BAA6B;AAC7B,4BAA2B;AAC3B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,4DAA2D;AAC3D,8BAA6B,EAAE;AAC/B;;AAEA,UAAS,oBAAoB;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA,4BAA2B;AAC3B,EAAC","file":"activity-unit-edit.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Users/liuge/Workspace/moviesys/dist/js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap af1d8375293f3aac4b39\n **/","'use strict;'\n\nvar common = require('common');\nvar _budgetSource = [];\nvar _plans = [];\nvar _wandaTicket = [];\nvar _movies = [];\nvar _filmType = [\n{ name: '2D' },\n{ name: '3D' },\n];\nvar _screenType = [\n{ name: '普通' },\n{ name: 'IMAX' },\n{ name: 'DMAX' },\n{ name: '巨幕' },\n];\nvar _hallType = [\n{ name: '普通' },\n{ name: '4D' },\n{ name: '5D' },\n];\nvar _channels = [];\nvar _provinces = [];\nvar _cusTypes = ['新户', '老户'];\nvar _submitting = false;\nvar _priorities = [];\nvar _dimenChanged = false;\nvar _popupDataCache = {\n  dailyBudgetList: [],\n  cusTypes: [1, 2],\n  saleLimit: {},\n  channels: [],\n  hallType: ['普通'],\n  filmType: ['2D', '3D'],\n  screenType: ['普通'],\n  films: [],\n  cinemas: [],\n  timetables: [],\n};\n\n// var _loginTypes = [CL:'掌上生活登录', UD: '一网通登录', UA: '一卡通登录', UC: '信用卡登录'];\n\n$(function () {\n  common.init('activity-unit');\n\n  Number.prototype.between = function (a, b, flag) {\n    var min = Math.min.apply(Math, [a, b]);\n    var max = Math.max.apply(Math, [a, b]);\n    var _this = this;\n    if (this == 0 && flag == true) {\n      _this = -Infinity;\n    }\n\n    if (this == 0 && flag == false) {\n      _this = Infinity;\n    }\n\n    return _this >= min && _this <= max;\n  };\n\n  setProvince();\n  setBrand();\n\n  var urlParam = common.getUrlParam();\n  if (urlParam.unitId != undefined && urlParam.unitId != '') {\n    setEdit(urlParam.unitId);\n  } else {\n    if (urlParam.planId != undefined && urlParam.planId != '') {\n      setPlan(urlParam.planId);\n    } else {\n      setPlan(false);\n    }\n\n    setWandaTicket(false);\n    setBudgetSource(false);\n    setMovie(false);\n    $('#preview-dimen').html('影片制式：不限<br>屏幕规格：[普通]<br>特殊影厅：[普通]');\n    setChannel(false);\n    setPattern(1);\n    setPriority(false);\n  }\n\n  //upper of range\n  window.Parsley.addValidator('ur', {\n    validateString: function (value, requirement) {\n      var $inputs = $('input.parsley-range');\n      var fields = [];\n      $inputs.each(function (index, el) {\n        var ns = $(this).data('parsley-ur');\n        if (ns == requirement) {\n          var value = parseFloat($(el).val());\n          fields.push(value);\n        }\n      });\n\n      if (~~fields[0] == 0 || ~~fields[1] == 0) {\n        return true;\n      } else {\n        return fields[0] < fields[1];\n      }\n    },\n\n    priority: 32,\n    messages: {\n      en: 'This value should be the upper limit of the range.',\n      'zh-cn': '范围的下限与上限设置错误。',\n    },\n  });\n\n  $('#beginDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var startDate = new Date(ev.date.valueOf());\n    startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n    $('#endDate').datetimepicker('setStartDate', startDate);\n  });\n\n  $('#endDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var FromEndDate = new Date(ev.date.valueOf());\n    FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n    $('#beginDate').datetimepicker('setEndDate', FromEndDate);\n  });\n\n  $('#movieSelect').multiselect({\n    search: {\n      left: '<input type=\"text\" name=\"q\" class=\"form-control\" placeholder=\"候选...\" />',\n      right: '<input type=\"text\" name=\"q\" class=\"form-control\" placeholder=\"已选...\" />',\n    },\n    right: '#movieSelect_to',\n    rightAll: '#movieSelect_all',\n    rightSelected: '#movieSelect_right',\n    leftSelected: '#movieSelect_left',\n    leftAll: '#movieSelect_none',\n  });\n\n  $('#formUnit').parsley();\n\n});\n\n//周期选择\n$(document).on('click', '#repeatedDayAll', function (event) {\n  if ($(this).prop('checked') == true) {\n    $('input[name=repeatedDay]').prop('checked', true);\n  } else {\n    $('input[name=repeatedDay]').prop('checked', false);\n  }\n\n});\n\n//优先级\n$(document).on('click', '#priority', function (event) {\n  event.preventDefault();\n  $('#popup-unit-priority').modal('show');\n  $('#popup-unit-priority input[type=text]').quicksearch('#priorityTable tbody tr', { selector: 'th' });\n  $('#popup-unit-priority form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-priority form', function (event) {\n  event.preventDefault();\n  var priority = +$('#popup-unit-priority input[type=text]').val();\n  if ($.inArray(priority, _priorities) > -1) {\n    alert('优先级重复，请换一个！');\n    return false;\n  }\n\n  $('#priority').val(priority);\n  $('#popup-unit-priority').modal('hide');\n  return false;\n});\n\n//成本中心\n$(document).on('change', '#level', function (event) {\n  event.preventDefault();\n  var level = $(this).val();\n  if (level == undefined || level == '') {\n    $('#budgetSource').html('<option value=\"\"></option>');\n  } else {\n    var sources = [];\n    _(_budgetSource).forEach(function (group, key) {\n      if (level == key) {\n        sources = group;\n      }\n    });\n\n    if (sources.length < 1) {\n      $('#budgetSource').html('<option value=\"\"></option>');\n      alert('所选成本中心类别下无成本中心，这个情况不正常，需要注意哦！');\n    } else {\n      var html = '';\n      _(sources).forEach(function (source) {\n        html += '<option value=\"' + source.id + '\">' + source.sourceName + '</option>';\n      });\n\n      $('#budgetSource').html(html);\n      $('#budgetSource').closest('.form-group').show();\n    }\n  }\n});\n\n//活动形式\n$(document).on('click', '#btn-type-add', function (event) {\n  event.preventDefault();\n  var index = $('#typeTable tbody tr').size();\n  var data = { index: index };\n  var template = $('#type-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template, data);\n  $('#typeTable tbody').append(html);\n});\n\n$(document).on('click', '.btn-type-delete', function (event) {\n  event.preventDefault();\n  if ($('#typeTable tbody tr').length < 2) {\n    alert('作为一个负责任的系统，最后一条就不给你删了！');\n    return false;\n  }\n\n  if (window.confirm('确定要删除此条规则吗？')) {\n    $(this).closest('tr').remove();\n  }\n\n  return false;\n});\n\n// 活动预算\n$(document).on('click', '#btn-set-daily', function (event) {\n  event.preventDefault();\n\n  $('#totalAmount').val(_popupDataCache.totalAmount);\n  $('#totalTicket').val(_popupDataCache.totalTicket);\n  var html = '';\n  _(_popupDataCache.dailyBudgetList).forEach(function (daily) {\n    html += '<tr>';\n    html += '<td><input type=\"text\" class=\"form-control startDate\" required readonly placeholder=\"YYYY-MM-DD\" value=\"' + daily.startDate + '\"></td>';\n    html += '<td><input type=\"text\" class=\"form-control endDate\" required readonly placeholder=\"YYYY-MM-DD\" value=\"' + daily.endDate + '\"></td>';\n    html += '<td><input type=\"text\" class=\"form-control dailyAmount\" placeholder=\"不限\" data-parsley-pattern=\"^[1-9]{1}\\\\d*$\" value=\"' + daily.dailyAmount + '\"></td>';\n    html += '<td><input type=\"text\" class=\"form-control dailyTicket\" placeholder=\"不限\" data-parsley-pattern=\"^[1-9]{1}\\\\d*$\" value=\"' + daily.dailyTicket + '\"></td>';\n    html += '<td><button type=\"button\" class=\"btn btn-xs btn-primary btn-delete\">删除</button></td>';\n    html += '</tr>';\n  });\n\n  $('#dailyBudgetTable tbody').html(html);\n  if (html != '') {\n    $('.startDate').datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: 'zh-CN',\n      minView: 2,\n      todayHighlight: true,\n      autoclose: true,\n    }).on('changeDate', function (ev) {\n      var startDate = new Date(ev.date.valueOf());\n      startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n      $(this).closest('tr').find('.endDate').datetimepicker('setStartDate', startDate);\n    });\n\n    $('.endDate').datetimepicker({\n      format: 'yyyy-mm-dd',\n      language: 'zh-CN',\n      minView: 2,\n      todayHighlight: true,\n      autoclose: true,\n    }).on('changeDate', function (ev) {\n      var FromEndDate = new Date(ev.date.valueOf());\n      FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n      $(this).closest('tr').find('.startDate').datetimepicker('setEndDate', FromEndDate);\n    });\n  }\n\n  $('#popup-unit-budget').modal('show');\n  $('#popup-unit-budget form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-budget form', function (event) {\n  event.preventDefault();\n\n  //判断时间重叠\n  var dateRangeList = $('#dailyBudgetTable tbody tr').map(function () {\n    return { startDate: $(this).find('.startDate').val(), endDate: $(this).find('.endDate').val() };\n  }).get();\n  var dateRangeFlag = false;\n  for (var i = 0, j = dateRangeList.length; i < j; i++) {\n    for (var k = 0; k < j; k++) {\n      if (k != i) {\n        if (dateRangeList[i].startDate >= dateRangeList[k].startDate && dateRangeList[i].startDate <= dateRangeList[k].endDate) {\n          dateRangeFlag = true;\n          break;\n        }\n\n        if (dateRangeList[i].endDate >= dateRangeList[k].startDate && dateRangeList[i].endDate <= dateRangeList[k].endDate) {\n          dateRangeFlag = true;\n          break;\n        }\n      }\n    }\n\n    if (dateRangeFlag) {\n      break;\n    }\n  }\n\n  if (dateRangeFlag) {\n    alert('日期区间不可以重叠！');\n    return false;\n  }\n\n  var previewHtml = '';\n  _popupDataCache.totalAmount = $('#totalAmount').val();\n  previewHtml += _popupDataCache.totalAmount > 0 ? '总金额预算：' + _popupDataCache.totalAmount + '；' : '总金额预算：不限；';\n  _popupDataCache.totalTicket = $('#totalTicket').val();\n  previewHtml += _popupDataCache.totalTicket > 0 ? '总出票预算：' + _popupDataCache.totalTicket + '；' : '总出票预算：不限；';\n  _popupDataCache.dailyBudgetList = [];\n  if ($('#dailyBudgetTable tbody tr').size() > 0) {\n    $('#dailyBudgetTable tbody tr').each(function (index, el) {\n      var startDate = $(el).find('.startDate').val();\n      var endDate = $(el).find('.endDate').val();\n      var dailyAmount = $(el).find('.dailyAmount').val();\n      var dailyTicket = $(el).find('.dailyTicket').val();\n      _popupDataCache.dailyBudgetList.push({ startDate: startDate, endDate: endDate, dailyAmount: dailyAmount, dailyTicket: dailyTicket });\n      dailyAmount = dailyAmount == 0 ? '不限' : dailyAmount;\n      dailyTicket = dailyTicket == 0 ? '不限' : dailyTicket;\n      previewHtml += '<p>' + startDate + ' ~ ' + endDate + '，日金额预算：' + dailyAmount + '，日出票预算：' + dailyTicket + '；</p>';\n    });\n  }\n\n  $('#preview-budget').html(previewHtml != '' ? previewHtml : '不限');\n  $('#popup-unit-budget').modal('hide');\n  return false;\n});\n\n$(document).on('click', '#btn-daily', function (event) {\n  event.preventDefault();\n  var template = $('#daily-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template);\n  $('#dailyBudgetTable tbody').append(html);\n  $('#popup-unit-budget').scrollTop($('#popup-unit-budget').height());\n\n  $('.startDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var startDate = new Date(ev.date.valueOf());\n    startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.endDate').datetimepicker('setStartDate', startDate);\n  });\n\n  $('.endDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var FromEndDate = new Date(ev.date.valueOf());\n    FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.startDate').datetimepicker('setEndDate', FromEndDate);\n  });\n\n});\n\n$(document).on('click', '#dailyBudgetTable .btn-delete', function (event) {\n  event.preventDefault();\n  if (window.confirm('确定要删除该条日预算吗？')) {\n    $(this).closest('tr').remove();\n  }\n});\n\n//客群\n$(document).on('click', '#btn-set-custypes', function (event) {\n  event.preventDefault();\n  $('input[name=customerType]').prop('checked', false);\n  _(_popupDataCache.cusTypes).forEach(function (cus) {\n    $('input[name=customerType]').eq(cus - 1).prop('checked', true);\n  });\n\n  $('#popup-unit-custypes').modal('show');\n  $('#popup-unit-custypes form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-custypes form', function (event) {\n  event.preventDefault();\n  var previewHtml = '';\n  _popupDataCache.cusTypes = $('input[name=customerType]:checked').map(function () {return ~~$(this).val();}).get();\n  if (_popupDataCache.cusTypes.length == _cusTypes.length) {\n    previewHtml = '不限';\n  } else {\n    previewHtml = $('input[name=customerType]:checked').map(function () {return $(this).next('span').text();}).get().join('、');\n  }\n\n  $('#preview-custypes').html(previewHtml);\n  $('#popup-unit-custypes').modal('hide');\n  return false;\n});\n\n//特殊资格\n$(document).on('click', '#btn-set-special', function (event) {\n  event.preventDefault();\n  $('input[name=specialType]').prop('checked', _popupDataCache.qualification == 'UD' ? true : false);\n  $('#popup-unit-special').modal('show');\n  $('#popup-unit-special form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-special form', function (event) {\n  event.preventDefault();\n  if ($('input[name=specialType]:checked').val() == 'UD') {\n    _popupDataCache.qualification = 'UD';\n  } else {\n    delete _popupDataCache.qualification;\n  }\n\n  $('#preview-special').html(_popupDataCache.qualification == 'UD' ? '手机银行一网通登录用户' : '不限');\n  $('#popup-unit-special').modal('hide');\n  return false;\n});\n\n//单户限购\n$(document).on('click', '#btn-set-restriction', function (event) {\n  event.preventDefault();\n  $('#saleLimit_dailyOrder').val(~~_popupDataCache.saleLimit.dailyOrder == 0 ? '' : _popupDataCache.saleLimit.dailyOrder);\n  $('#saleLimit_dailyTicket').val(~~_popupDataCache.saleLimit.dailyTicket == 0 ? '' : _popupDataCache.saleLimit.dailyTicket);\n  $('#saleLimit_totalOrder').val(~~_popupDataCache.saleLimit.totalOrder == 0 ? '' : _popupDataCache.saleLimit.totalOrder);\n  $('#saleLimit_totalTicket').val(~~_popupDataCache.saleLimit.totalTicket == 0 ? '' : _popupDataCache.saleLimit.totalTicket);\n  $('#popup-unit-restriction').modal('show');\n  $('#popup-unit-restriction form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-restriction form', function (event) {\n  event.preventDefault();\n  _popupDataCache.saleLimit.dailyTicket = ~~$('#saleLimit_dailyTicket').val() == 0 ? '' : $('#saleLimit_dailyTicket').val();\n  _popupDataCache.saleLimit.dailyOrder = ~~$('#saleLimit_dailyOrder').val() == 0 ? '' : $('#saleLimit_dailyOrder').val();\n  _popupDataCache.saleLimit.totalTicket = ~~$('#saleLimit_totalTicket').val() == 0 ? '' : $('#saleLimit_totalTicket').val();\n  _popupDataCache.saleLimit.totalOrder = ~~$('#saleLimit_totalOrder').val() == 0 ? '' : $('#saleLimit_totalOrder').val();\n  var previewHtml = '';\n  previewHtml += ~~_popupDataCache.saleLimit.dailyTicket == 0 ? '' : '每日限购' + _popupDataCache.saleLimit.dailyTicket + '张；';\n  previewHtml += ~~_popupDataCache.saleLimit.totalTicket == 0 ? '' : '总共限购' + _popupDataCache.saleLimit.totalTicket + '张；';\n  previewHtml += ~~_popupDataCache.saleLimit.dailyOrder == 0 ? '' : '每日限购' + _popupDataCache.saleLimit.dailyOrder + '笔；';\n  previewHtml += ~~_popupDataCache.saleLimit.totalOrder == 0 ? '' : '总共限购' + _popupDataCache.saleLimit.totalOrder + '笔；';\n  $('#preview-restriction').html(previewHtml != '' ? previewHtml : '不限');\n  $('#popup-unit-restriction').modal('hide');\n  return false;\n});\n\n//渠道\n$(document).on('click', '#btn-set-channel', function (event) {\n  event.preventDefault();\n  setChannel(_popupDataCache.channels);\n  var data = { channels: _channels };\n  var template = $('#channel-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template, data);\n  $('#popup-unit-channel .modal-body').html(html);\n  $('#popup-unit-channel').modal('show');\n  $('#popup-unit-channel form').parsley();\n});\n\n$(document).on('submit', '#popup-unit-channel form', function (event) {\n  event.preventDefault();\n  _popupDataCache.channels = $('input[name=channels]:checked').map(function () {return ~~$(this).val();}).get();\n  var previewHtml = _popupDataCache.channels.length == _channels.length ? '不限' : $('input[name=channels]:checked').map(function () {return $(this).next('span').text();}).get().join('、');\n  $('#preview-channel').html(previewHtml);\n  $('#popup-unit-channel').modal('hide');\n  return false;\n});\n\n//影片\n$(document).on('click', '#btn-set-movie', function (event) {\n  event.preventDefault();\n  var html = '';\n  var choosedHtml = '';\n  _(_movies).forEach(function (movie) {\n    if (_popupDataCache.films != null && _popupDataCache.films.indexOf(movie.filmId) > -1) {\n      choosedHtml += '<option value=\"' + movie.filmId + '\">' + movie.filmName + '</option>';\n    } else {\n      html += '<option value=\"' + movie.filmId + '\">' + movie.filmName + '</option>';\n    }\n  });\n\n  $('#movieSelect').html(html);\n  $('#movieSelect_to').html(choosedHtml);\n  $('#popup-unit-movie').modal('show');\n});\n\n$(document).on('click', '#popup-unit-movie button[type=submit]', function (event) {\n  $('.multi-selection select:eq(1) option').prop('selected', true);\n});\n\n$(document).on('submit', '#popup-unit-movie form', function (event) {\n  event.preventDefault();\n  var previewHtml = '';\n  if ($('#movieSelect_to option').length > 0) {\n    _popupDataCache.films = $('#movieSelect_to option').map(function () {return ~~$(this).val();}).get();\n    previewHtml = $('#movieSelect_to option').map(function () {return $(this).val() + '[' + $(this).text() + ']';}).get().join(' ');\n  } else {\n    _popupDataCache.films = [];\n    previewHtml = '不限';\n  }\n\n  $('#preview-movie').html(previewHtml);\n  $('#popup-unit-movie').modal('hide');\n  return false;\n});\n\n//制式\n$(document).on('click', '#btn-set-dimen', function (event) {\n  event.preventDefault();\n  _(_filmType).forEach(function (dimen) {\n    dimen.checked = true;\n    if (_popupDataCache.filmType.indexOf(dimen.name) < 0) {\n      dimen.checked = false;\n    }\n  });\n\n  _(_screenType).forEach(function (dimen) {\n    dimen.checked = true;\n    if (_popupDataCache.screenType.indexOf(dimen.name) < 0) {\n      dimen.checked = false;\n    }\n  });\n\n  _(_hallType).forEach(function (dimen) {\n    dimen.checked = true;\n    if (_popupDataCache.hallType.indexOf(dimen.name) < 0) {\n      dimen.checked = false;\n    }\n  });\n\n  var data = { filmType: _filmType, screenType: _screenType, hallType: _hallType };\n  var template = $('#dimen-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template, data);\n  $('#popup-unit-dimen .modal-body').html(html);\n  $('#popup-unit-dimen').modal('show');\n  $('#popup-unit-dimen form').parsley();\n});\n\n$(document).on('change', '#popup-unit-dimen input[type=checkbox]', function (event) {\n  event.preventDefault();\n  _dimenChanged = true;\n});\n\n$(document).on('submit', '#popup-unit-dimen form', function (event) {\n  event.preventDefault();\n\n  if (!_dimenChanged) {\n    _dimenChanged = true;\n    if (!window.confirm('已为您默认选择普通厅、普通屏幕、2D3D影片，是否确认保存？')) {\n      return false;\n    }\n  }\n\n  var previewHtmlFilmType = '影片制式：';\n  _popupDataCache.filmType = $('input[name=filmType]:checked').map(function () {return $(this).next('span').text();}).get();\n  if (_popupDataCache.filmType.length == _filmType.length) {\n    previewHtmlFilmType += '不限';\n  } else {\n    previewHtmlFilmType += '[' + _popupDataCache.filmType.join('] [') + ']';\n  }\n\n  var previewHtmlScreenType = '<br>屏幕规格：';\n  _popupDataCache.screenType = $('input[name=screenType]:checked').map(function () {return $(this).next('span').text();}).get();\n  if (_popupDataCache.screenType.length == _screenType.length) {\n    previewHtmlScreenType += '不限';\n  } else {\n    previewHtmlScreenType += '[' + _popupDataCache.screenType.join('] [') + ']';\n  }\n\n  var previewHtmlHallType = '<br>特殊影厅：';\n  _popupDataCache.hallType = $('input[name=hallType]:checked').map(function () {return $(this).next('span').text();}).get();\n  if (_popupDataCache.hallType.length == _hallType.length) {\n    previewHtmlHallType += '不限';\n  } else {\n    previewHtmlHallType += '[' + _popupDataCache.hallType.join('] [') + ']';\n  }\n\n  $('#preview-dimen').html(previewHtmlFilmType + previewHtmlScreenType + previewHtmlHallType);\n  $('#popup-unit-dimen').modal('hide');\n  return false;\n});\n\n//影院\n$(document).on('click', '#btn-set-cinema', function (event) {\n  event.preventDefault();\n  $('#search-cinema-brandId option ,#search-cinema-provinceId option').prop('selected', false);\n  $('#search-cinema-cityId').html('<option value=\"\">城市</option>');\n  $('#search-cinema-candidate tbody, #search-cinema-choosed tbody').html('');\n  $('#input-cinema-filter, #search-cinema-cinemaName').val('');\n  if (_popupDataCache.cinemas != null && _popupDataCache.cinemas.length > 0) {\n    var html = '';\n    _(_popupDataCache.cinemas).forEach(function (cinema) {\n      html += '<tr data-id=\"' + cinema.cinemaId + '\"><td>' + cinema.cinemaName + '</td><td>' + cinema.cityName + '</td><td>' + cinema.brandName + '</td></tr>';\n    });\n\n    $('#search-cinema-choosed tbody').html(html);\n    $('#input-cinema-filter').quicksearch('#search-cinema-choosed tbody tr');\n  }\n\n  $('#popup-unit-cinema').modal('show');\n});\n\n$(document).on('change', '#search-cinema-provinceId', function (e) {\n  var provinceId = parseInt($(this).val());\n  var options = '';\n  if (!!+provinceId) {\n    var province = _.find(_provinces, { provinceId: provinceId.toString() });\n    var cityList = province.cityList;\n    _(cityList).forEach(function (value, key) {\n      options += '<option value=\"' + value.cityId + '\">' + value.cityName + '</option>';\n    });\n  } else {\n    options = '<option value=\"\">城市</option>';\n  }\n\n  $('#search-cinema-cityId').html(options);\n  return false;\n});\n\n$(document).on('click', '#btn-search-cinema', function (event) {\n  event.preventDefault();\n  var sendData = {\n    brandId: $('#search-cinema-brandId').val(),\n    cityId: $('#search-cinema-cityId').val(),\n    cinemaName: $.trim($('#search-cinema-cinemaName').val()),\n    associationStatus: 1,\n    onlineStatus: 1,\n    pageIndex: 1,\n    pageSize: 9999,\n  };\n  if (sendData.brandId == '' && sendData.cityId == '') {\n    alert('院线或城市，请至少选择一个！');\n    $('#search-cinema-brandId').focus();\n    return false;\n  }\n\n  $('#search-cinema-candidate tbody').html('<tr><td colspan=\"3\" align=\"center\">查询中，请稍等...</td></tr>');\n  $.ajax({\n    url: common.API_HOST + 'common/cinemas',\n    type: 'POST',\n    dataType: 'json',\n    data: sendData,\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      if (res.data.rows.length <= 0) {\n        $('#search-cinema-candidate tbody').html('<tr><td colspan=\"3\" align=\"center\">查不到数据！</td></tr>');\n        return false;\n      }\n\n      var html = '';\n      _(res.data.rows).forEach(function (cinema) {\n        html += '<tr data-id=\"' + cinema.id + '\"><td>' + cinema.name + '</td><td>' + cinema.cityName + '</td><td>' + cinema.brandName + '</td></tr>';\n      });\n\n      $('#search-cinema-candidate tbody').html(html);\n    } else {\n      $('#search-cinema-candidate tbody').html('<tr><td colspan=\"3\" align=\"center\">查不到数据！</td></tr>');\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n});\n\n$(document).on('click', '#search-cinema-candidate tbody tr, #search-cinema-choosed tbody tr', function (event) {\n  event.preventDefault();\n  $(this).toggleClass('selected');\n});\n\n$(document).on('click', '#search-cinema-add-all', function (event) {\n  event.preventDefault();\n  var choosedIds = [];\n  $('#search-cinema-choosed tbody tr').each(function (index, el) {\n    choosedIds.push($(el).data('id'));\n  });\n\n  $('#search-cinema-candidate tbody tr').each(function (index, el) {\n    if (choosedIds.indexOf($(el).data('id')) == -1) {\n      $(el).clone().appendTo('#search-cinema-choosed tbody').removeClass('selected');\n    }\n  });\n\n  $('#input-cinema-filter').quicksearch('#search-cinema-choosed tbody tr');\n  $('#choosedCount').text($('#search-cinema-choosed tbody tr').length);\n});\n\n$(document).on('click', '#search-cinema-add', function (event) {\n  event.preventDefault();\n  var choosedIds = [];\n  $('#search-cinema-choosed tbody tr').each(function (index, el) {\n    choosedIds.push($(el).data('id'));\n  });\n\n  $('#search-cinema-candidate tbody tr.selected').each(function (index, el) {\n    if (choosedIds.indexOf($(el).data('id')) == -1) {\n      $(el).clone().appendTo('#search-cinema-choosed tbody').removeClass('selected');\n    }\n  });\n\n  $('#input-cinema-filter').quicksearch('#search-cinema-choosed tbody tr');\n  $('#choosedCount').text($('#search-cinema-choosed tbody tr').length);\n});\n\n$(document).on('click', '#search-cinema-remove-all', function (event) {\n  event.preventDefault();\n  $('#search-cinema-choosed tbody tr').remove();\n  $('#input-cinema-filter').quicksearch('#search-cinema-choosed tbody tr');\n  $('#choosedCount').text('0');\n});\n\n$(document).on('click', '#search-cinema-remove', function (event) {\n  event.preventDefault();\n  $('#search-cinema-choosed tbody tr.selected').remove();\n  $('#input-cinema-filter').quicksearch('#search-cinema-choosed tbody tr');\n  $('#choosedCount').text($('#search-cinema-choosed tbody tr').length);\n});\n\n$(document).on('click', '#btn-cinema-filter', function (event) {\n  event.preventDefault();\n  $('#input-cinema-filter').val('');\n  $('#search-cinema-choosed tbody tr').show();\n});\n\n$(document).on('submit', '#popup-unit-cinema form', function (event) {\n  event.preventDefault();\n  _popupDataCache.cinemas = $('#search-cinema-choosed tbody tr').map(function () {\n    var cinema = {\n      cinemaId: $(this).data('id'),\n      cinemaName: $(this).find('td:nth-child(1)').html(),\n      cityName: $(this).find('td:nth-child(2)').html(),\n      brandName: $(this).find('td:nth-child(3)').html(),\n    };\n    return cinema;\n  }).get();\n  var previewHtml = _popupDataCache.cinemas.length > 0 ? '选择了 ' + _popupDataCache.cinemas.length + ' 个影院' : '不限';\n  $('#preview-cinema').html(previewHtml);\n  $('#popup-unit-cinema').modal('hide');\n  return false;\n});\n\n//场次\n$(document).on('click', '#btn-set-timetable', function (event) {\n  event.preventDefault();\n  var html = '';\n  _(_popupDataCache.timetables).forEach(function (time) {\n    html += '<tr><td><input type=\"text\" class=\"form-control beginDate\" required value=\"' + time.beginDate + '\"></td><td><input type=\"text\" class=\"form-control endDate\" required value=\"' + time.endDate + '\"></td><td><input type=\"text\" class=\"form-control beginTime\" required value=\"' + time.beginTime + '\"></td><td><input type=\"text\" class=\"form-control endTime\" required value=\"' + time.endTime + '\"></td><td><button type=\"button\" class=\"btn btn-xs btn-primary btn-delete\">删除</button></td></tr>';\n  });\n\n  $('#timeTable tbody').html(html);\n  resetTimeTable();\n  $('#popup-unit-timetable').modal('show');\n  $('#popup-unit-timetable form').parsley();\n});\n\n$(document).on('click', '#btn-timetable', function (event) {\n  event.preventDefault();\n  var template = $('#timetable-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template);\n  $('#timeTable tbody').append(html);\n  $('#popup-unit-timetable').scrollTop($('#popup-unit-timetable').height());\n  resetTimeTable();\n});\n\n$(document).on('click', '#timeTable .btn-delete', function (event) {\n  event.preventDefault();\n  if (window.confirm('确定要删除该条场次限制吗？')) {\n    $(this).closest('tr').remove();\n  }\n});\n\n$(document).on('submit', '#popup-unit-timetable form', function (event) {\n  event.preventDefault();\n  _popupDataCache.timetables = $('#timeTable tbody tr').map(function () {\n    var time = {\n      beginDate: $(this).find('.beginDate').val(),\n      endDate: $(this).find('.endDate').val(),\n      beginTime: $(this).find('.beginTime').val(),\n      endTime: $(this).find('.endTime').val(),\n    };\n    return time;\n  }).get();\n  setTimeTable(_popupDataCache.timetables);\n  var previewHtml = '';\n  if (_popupDataCache.timetables.length > 0) {\n    _(_popupDataCache.timetables).forEach(function (time) {\n      previewHtml += '<p>' + time.beginDate + ' ~ ' + time.endDate + ' 每天 ' + time.beginTime + ' ~ ' + time.endTime + '</p>';\n    });\n\n    $('#preview-timetable').html(previewHtml);\n  } else {\n    $('#preview-timetable').html('不限');\n  }\n\n  $('#popup-unit-timetable').modal('hide');\n  return false;\n});\n\n$(document).on('change', '#activityPattern', function (event) {\n  event.preventDefault();\n  var current = +$(this).val();\n  setPattern(current);\n});\n\n$(document).on('click', '#formUnit button[type=submit]', function (event) {\n  var dailyEffectiveBeginTime = $('#beginHH').val() + ':' + $('#beginMM').val() + ':' + $('#beginSS').val();\n  var dailyEffectiveEndTime = $('#endHH').val() + ':' + $('#endMM').val() + ':' + $('#endSS').val();\n  if (dailyEffectiveBeginTime > dailyEffectiveEndTime) {\n    $('#error-dailytime').append('<ul class=\"parsley-errors-list filled\"><li>开始时间不能大于结束时间！</li></ul>');\n    $('#beginHH').focus();\n    event.preventDefault();\n    return false;\n  } else {\n    $('#error-dailytime').html('');\n  }\n});\n\n//form\n$(document).on('submit', '#formUnit', function (event) {\n  event.preventDefault();\n  if (_submitting) {\n    return false;\n  }\n\n  _submitting = true;\n  $('#formUnit input[type=submit]').prop('disabled', true).text('更新中...');\n  var sendData = {\n    name: $.trim($('#name').val()),\n    signNo: $('#signNo').val(),\n    planId: $('#planId').val(),\n    budgetSource: $('#budgetSource').val(),\n    wandaTicketId: $('#wandaTicketId').val(),\n    advancePayment: $('input[name=advancePayment]:checked').val(),\n    beginDate: $('#beginDate').val(),\n    endDate: $('#endDate').val(),\n    dailyEffectiveBeginTime: $('#beginHH').val() + ':' + $('#beginMM').val() + ':' + $('#beginSS').val(),\n    dailyEffectiveEndTime: $('#endHH').val() + ':' + $('#endMM').val() + ':' + $('#endSS').val(),\n    priority: $('#priority').val(),\n    cinemaPageDesc: $.trim($('#cinemaPageDesc').val()),\n    activityIcon: $.trim($('#activityIcon').val()),\n    timetablePageDesc: $.trim($('#timetablePageDesc').val()),\n    activityDesc: $.trim($('#activityDesc').val()),\n    activityLink: $.trim($('#activityLink').val()),\n    activityRuleDesc: $.trim($('#activityRuleDesc').val()),\n    repeatedDay: [],\n    customerType: _popupDataCache.cusTypes,\n    channels: _popupDataCache.channels,\n    hallType: _popupDataCache.hallType,\n    filmType: _popupDataCache.filmType,\n    screenType: _popupDataCache.screenType,\n    activityPattern: $('#activityPattern').val(),\n    activityPatternList: [],\n    totalAmount: _popupDataCache.totalAmount,\n    totalTicket: _popupDataCache.totalTicket,\n    dailyBudgetList: _popupDataCache.dailyBudgetList,\n    films: _popupDataCache.films,\n    cinemas: [],\n    timetables: _popupDataCache.timetables,\n  };\n\n  $('input[name=repeatedDay]:checked').each(function (index, el) {\n    sendData.repeatedDay.push($(el).val());\n  });\n\n  sendData.repeatedDay = sendData.repeatedDay.join(',');\n\n  //活动形式\n  var rangeList = [];\n  var patternCheck = true;\n  $('#typeTable tbody tr').each(function (index, el) {\n    var amount = $(el).find('.amount').val();\n    var lowerBound = Number($(el).find('.lowerBound').val());\n    var upperBound = Number($(el).find('.upperBound').val());\n\n    _(rangeList).forEach(function (range) {\n      var min = range.min == '' ? 0 : range.min;\n      var max = range.max == '' ? Infinity : range.max;\n      if (lowerBound.between(min, max, true) || upperBound.between(min, max, false)) {\n        $(el).find('#error-cross').remove();\n        $(el).find('td:nth-child(2)').append('<ul class=\"parsley-errors-list filled\" id=\"error-cross\"><li class=\"parsley-required\">活动形式价格区间交叉了</li></ul>');\n        $(el).find('.lowerBound').focus();\n        patternCheck = false;\n        return false;\n      }\n    });\n\n    if (!patternCheck) {\n      return false;\n    }\n\n    rangeList.push({ min: lowerBound, max: upperBound });\n    sendData.activityPatternList.push({ amount: amount, lowerBound: lowerBound == 0 ? '' : lowerBound, upperBound: upperBound == 0 ? '' : upperBound });\n  });\n\n  if (!patternCheck) {\n    return false;\n  }\n\n  if (_popupDataCache.qualification != undefined && _popupDataCache.qualification != null && _popupDataCache.qualification != '') {\n    sendData.qualification = [_popupDataCache.qualification];\n  }\n\n  if (~~_popupDataCache.saleLimit.dailyTicket == 0 && ~~_popupDataCache.saleLimit.dailyOrder == 0 && ~~_popupDataCache.saleLimit.totalTicket == 0 && ~~_popupDataCache.saleLimit.totalOrder == 0) {\n    delete sendData.saleLimit;\n  } else {\n    sendData.saleLimit = _popupDataCache.saleLimit;\n  }\n\n  _(_popupDataCache.cinemas).forEach(function (cinema) {\n    sendData.cinemas.push(cinema.cinemaId);\n  });\n\n  var ajaxUrl = 'activity/saveActivity';\n  if ($('#id').size() > 0) {\n    ajaxUrl = 'activity/updateActivity';\n    sendData.id = $('#id').val();\n  }\n\n  $.ajax({\n    url: common.API_HOST + ajaxUrl,\n    type: 'POST',\n    dataType: 'json',\n    contentType: 'application/json; charset=utf-8',\n    data: JSON.stringify(sendData),\n  })\n  .done(function (res) {\n    _submitting = false;\n    $('#formUnit input[type=submit]').prop('disabled', false).text('保存');\n    if (!!~~res.meta.result) {\n      if (ajaxUrl == 'activity/updateActivity') {\n        alert('更新成功！');\n        document.location.reload(true);\n      } else {\n        alert('新建成功！');\n        document.location = 'activity-unit.html';\n      }\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n\n  return false;\n});\n\n//数据缓存\nfunction setBudgetSource(budgetSourceId) {\n  $.ajax({\n    url: common.API_HOST + 'activity/budgetSourceList',\n    type: 'POST',\n    dataType: 'json',\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      _budgetSource = res.data;\n      if (!!~~budgetSourceId) {\n        var html = '';\n        var levelId = 0;\n        _(_budgetSource).forEach(function (group, key) {\n          _(group).forEach(function (source) {\n            if (budgetSourceId == source.id) {\n              levelId = parseInt(key);\n            }\n          });\n        });\n\n        $('#level option').eq(1 + levelId).prop('selected', true);\n        _(_budgetSource[levelId]).forEach(function (source) {\n          if (budgetSourceId == source.id) {\n            html += '<option value=\"' + source.id + '\" selected>' + source.sourceName + '</option>';\n          } else {\n            html += '<option value=\"' + source.id + '\">' + source.sourceName + '</option>';\n          }\n        });\n\n        $('#budgetSource').html(html);\n      }\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setBrand() {\n  $.ajax({\n    url: common.API_HOST + 'common/brandList',\n    type: 'GET',\n    dataType: 'json',\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      _(res.data).forEach(function (brand) {\n        $('#search-cinema-brandId').append($('<option></option>').attr('value', brand.id).text(brand.name));\n      });\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setPriority(exclude) {\n  $.ajax({\n    url: common.API_HOST + 'activity/activityList',\n    type: 'POST',\n    dataType: 'json',\n    data: { pageIndex: 1, pageSize: 999999, sord: 'priority', sidx: 'DESC' },\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      var html = '';\n      _(res.data.rows).forEach(function (value, key) {\n        if (value.priority != exclude) {\n          _priorities.push(value.priority);\n          html += '<tr><th>' + value.priority + '</th><td>' + value.name + '</td></tr>';\n        }\n\n      });\n\n      $('#priorityTable tbody').html(html);\n\n      $('#popup-unit-priority button[type=submit]').prop('disabled', false);\n      $('#popup-unit-priority input[type=text]').val($('#priority').val());\n      $('#popup-unit-priority input[type=text]').quicksearch('#priorityTable tbody tr');\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setPlan(planId) {\n  $.ajax({\n    url: common.API_HOST + 'plan/planList',\n    type: 'POST',\n    dataType: 'json',\n    data: { status: 1, pageIndex: 1, pageSize: 9999 },\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      if (res.data == null || res.data.rows.length < 1) {\n        alert('没有已上线的计划，这不正常哦！');\n        return false;\n      } else {\n        _plans = res.data.rows;\n        var html = '';\n        _(_plans).forEach(function (plan) {\n          if (planId == plan.id) {\n            html += '<option value=\"' + plan.id + '\" selected>' + plan.name + '</option>';\n          } else {\n            html += '<option value=\"' + plan.id + '\">' + plan.name + '</option>';\n          }\n        });\n\n        $('#planId').append(html);\n      }\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setWandaTicket(wandaTicketId) {\n  $.ajax({\n    url: common.API_HOST + 'activity/wandaActivityTicketList',\n    type: 'GET',\n    dataType: 'json',\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      if (res.data == null || res.data.wandaTicketList.length < 1) {\n        return false;\n      } else {\n        _wandaTicket = res.data.wandaTicketList;\n        var html = '';\n        _(_wandaTicket).forEach(function (ticket) {\n          if (wandaTicketId == ticket.id) {\n            html += '<option value=\"' + ticket.id + '\" selected>' + ticket.ticketId + '</option>';\n          } else {\n            html += '<option value=\"' + ticket.id + '\">' + ticket.ticketId + '</option>';\n          }\n        });\n\n        $('#wandaTicketId').append(html);\n      }\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setMovie(films) {\n  var previewHtml = '';\n  if (_movies.length > 0) {\n    if (films == false) {\n      previewHtml = '不限';\n    } else {\n      _(_movies).forEach(function (movie) {\n        if (films.indexOf(movie.filmId) > -1) {\n          previewHtml += movie.filmId + '[' + movie.filmName + '] ';\n        }\n      });\n    }\n\n    $('#preview-movie').html(previewHtml);\n  } else {\n    $.ajax({\n      url: common.API_HOST + 'common/filmList',\n      type: 'GET',\n      dataType: 'json',\n    })\n    .done(function (res) {\n      if (!!~~res.meta.result) {\n        if (res.data == null || res.data.length < 1) {\n          return false;\n        } else {\n          _movies = res.data;\n          if (films == false) {\n            previewHtml = '不限';\n          } else {\n            _(_movies).forEach(function (movie) {\n              if (films.indexOf(movie.filmId) > -1) {\n                previewHtml += movie.filmId + '[' + movie.filmName + '] ';\n              }\n            });\n          }\n\n          $('#preview-movie').html(previewHtml);\n        }\n      } else {\n        alert('接口错误：' + res.meta.msg);\n      }\n    });\n  }\n}\n\nfunction setChannel(channels) {\n  var previewHtml = '';\n  var checkedChannelNames = [];\n  if (_channels.length > 0) {\n    if (channels == false || _channels.length == channels.length) {\n      _(_channels).forEach(function (channel) {channel.checked = true;});\n\n      previewHtml = '不限';\n    } else {\n      _(_channels).forEach(function (channel) {\n        if (channels.indexOf(channel.channelId) < 0) {\n          channel.checked = false;\n        } else {\n          channel.checked = true;\n          checkedChannelNames.push(channel.channelName);\n        }\n      });\n\n      previewHtml = checkedChannelNames.join('、');\n    }\n\n    $('#preview-channel').html(previewHtml);\n  } else {\n    $.ajax({\n      url: common.API_HOST + 'common/channelList',\n      type: 'GET',\n      dataType: 'json',\n    })\n    .done(function (res) {\n      if (!!~~res.meta.result) {\n        if (res.data == null || res.data.length < 1) {\n          return false;\n        } else {\n          _channels = res.data;\n          if (channels == false || _channels.length == channels.length) {\n            _popupDataCache.channels = [];\n            _(_channels).forEach(function (channel) {\n              _popupDataCache.channels.push(~~channel.channelId);\n              channel.checked = true;\n            });\n\n            previewHtml = '不限';\n          } else {\n            _(_channels).forEach(function (channel) {\n              if (channels.indexOf(channel.channelId.toString()) < 0) {\n                channel.checked = false;\n              } else {\n                channel.checked = true;\n                checkedChannelNames.push(channel.channelName);\n              }\n            });\n\n            previewHtml = checkedChannelNames.join('、');\n          }\n\n          $('#preview-channel').html(previewHtml);\n        }\n      } else {\n        alert('接口错误：' + res.meta.msg);\n      }\n    });\n  }\n}\n\nfunction setProvince() {\n  $.ajax({\n    url: common.API_HOST + 'common/provinceList',\n    type: 'GET',\n    dataType: 'json',\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      _provinces = res.data;\n      var html = '';\n      _(_provinces).forEach(function (province) {\n        html += '<option value=\"' + province.provinceId + '\">' + province.provinceName + '</option>';\n      });\n\n      $('#search-cinema-provinceId').append(html);\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\nfunction setPattern(patternId) {\n  switch (~~patternId) {\n    case 0:\n    case 1:\n    case 2:\n      $('.amount').attr('data-parsley-pattern', '^[1-9]{1}\\\\d*.{1}\\\\d{1,2}$|^[1-9]{1}\\\\d*$|^[0].{1}\\\\d{1,2}$');\n      $('.activity-pattern-tip').text('金额需输入大于0的数字，最多两位小数');\n    break;\n    case 3:\n      $('.amount').attr('data-parsley-pattern', '^[1-9]{1}$');\n      $('.activity-pattern-tip').text('折扣需输入大于0且小于10的整数；金额需输入大于0的数字，最多两位小数');\n    break;\n    case 4:\n      $('.amount').attr('data-parsley-pattern', '^[234]{1}$');\n      $('.activity-pattern-tip').text('张数仅限输入2、3、4；金额需输入大于0的数字，最多两位小数');\n    break;\n    case 5:\n      $('.amount').attr('data-parsley-pattern', '^[1-9]{1}\\\\d*.{1}\\\\d{1,2}$|^[1-9]{1}\\\\d*$|^[0].{1}\\\\d{1,2}$');\n      $('.activity-pattern-tip').text('积分需输入大于0的整数；金额需输入大于0的数字，最多两位小数');\n    break;\n  }\n}\n\nfunction setTimeTable(timetables) {\n  var previewHtml = '';\n  if (timetables == false || timetables == null || timetables.length == 0) {\n    previewHtml = '不限';\n  } else {\n    _(timetables).forEach(function (time) {\n      previewHtml += '<p>' + time.beginDate + ' ~ ' + time.endDate + ' 每天 ' + time.beginTime + ' ~ ' + time.endTime + '</p>';\n    });\n  }\n\n  $('#preview-timetable').html(previewHtml);\n}\n\nfunction resetTimeTable() {\n  $('.beginDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var startDate = new Date(ev.date.valueOf());\n    startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.endDate').datetimepicker('setStartDate', startDate);\n  });\n\n  $('.endDate').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var FromEndDate = new Date(ev.date.valueOf());\n    FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.beginDate').datetimepicker('setEndDate', FromEndDate);\n  });\n\n  $('.beginTime').datetimepicker({\n    format: 'hh:ii',\n    language: 'zh-CN',\n    startView: 1,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var startDate = new Date(ev.date.valueOf());\n    startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.endTime').datetimepicker('setStartDate', startDate);\n  });\n\n  $('.endTime').datetimepicker({\n    format: 'hh:ii',\n    language: 'zh-CN',\n    startView: 1,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var FromEndDate = new Date(ev.date.valueOf());\n    FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n    $(this).closest('tr').find('.beginTime').datetimepicker('setEndDate', FromEndDate);\n  });\n}\n\nfunction setEdit(unitId) {\n  $('.breadcrumb li:last-child').text('编辑');\n  $('h3').text('编辑活动单元:' + unitId);\n  $.ajax({\n    url: common.API_HOST + 'activity/activityDetail',\n    type: 'POST',\n    dataType: 'json',\n    data: { id: unitId },\n  })\n  .done(function (res) {\n    if (!!~~res.meta.result) {\n      var unit = res.data;\n      if (unit == null || unit == undefined) {\n        alert('无法获取要编辑的活动单元信息，这个不太正常，让[猿们]来查一查！');\n        return false;\n      }\n\n      _popupDataCache.totalAmount = ~~unit.totalAmount < 1 ? '' : ~~unit.totalAmount;\n      _popupDataCache.totalTicket = ~~unit.totalTicket < 1 ? '' : ~~unit.totalTicket;\n      _popupDataCache.dailyBudgetList = unit.dailyBudgetList;\n      _popupDataCache.cusTypes = unit.cusTypes;\n      _popupDataCache.channels = unit.channels;\n      _popupDataCache.films = unit.films;\n      _popupDataCache.filmType = unit.filmType;\n      _popupDataCache.screenType = unit.screenType;\n      _popupDataCache.hallType = unit.hallType;\n      _popupDataCache.qualification = unit.qualification != undefined ? unit.qualification[0] : '';\n\n      if (unit.cinemas != null) {\n        $.ajax({\n          url: common.API_HOST + 'common/getCinemasByIds',\n          type: 'POST',\n          dataType: 'json',\n          data: { ids: unit.cinemas.join('|') },\n        })\n        .done(function (res) {\n          if (!!~~res.meta.result) {\n            if (res.data == null || res.data.length < 1) {\n              return false;\n            } else {\n              _popupDataCache.cinemas = res.data;\n            }\n          } else {\n            alert('接口错误：' + res.meta.msg);\n          }\n        });\n      }\n\n      _popupDataCache.timetables = unit.timetables;\n\n      if (unit.saleLimit == null) {\n        _popupDataCache.saleLimit = { dailyOrder: '', dailyTicket: '', totalOrder: '', totalTicket: '' };\n      } else {\n        _popupDataCache.saleLimit = {\n          dailyOrder: ~~unit.saleLimit.dailyOrder == 0 ? '' : unit.saleLimit.dailyOrder,\n          dailyTicket: ~~unit.saleLimit.dailyTicket == 0 ? '' : unit.saleLimit.dailyTicket,\n          totalOrder: ~~unit.saleLimit.totalOrder == 0 ? '' : unit.saleLimit.totalOrder,\n          totalTicket: ~~unit.saleLimit.totalTicket == 0 ? '' : unit.saleLimit.totalTicket,\n        };\n      }\n\n      setPriority(unit.priority);\n\n      $('#formUnit').prepend('<input type=\"hidden\" id=\"id\" value=\"' + unit.id + '\">');\n\n      $('#name').val(unit.name).prop('disabled', true);\n      $('#signNo').val(unit.signNo).prop('disabled', true);\n\n      $('#beginDate').val(unit.beginDate.split(' ')[0]);\n      $('#endDate').val(unit.endDate.split(' ')[0]);\n      var dailyEffectBeginTime = unit.dailyEffectBeginTime.split(':');\n      $('#beginHH').val(dailyEffectBeginTime[0]);\n      $('#beginMM').val(dailyEffectBeginTime[1]);\n      $('#beginSS').val(dailyEffectBeginTime[2]);\n      var dailyEffectEndTime = unit.dailyEffectEndTime.split(':');\n      $('#endHH').val(dailyEffectEndTime[0]);\n      $('#endMM').val(dailyEffectEndTime[1]);\n      $('#endSS').val(dailyEffectEndTime[2]);\n      var repeatedDay = unit.repeatedDay.split(',');\n      _(repeatedDay).forEach(function (day) {\n        $('input[name=repeatedDay]').eq(day - 1).prop('checked', true);\n      });\n\n      if (repeatedDay.length == 7) {\n        $('#repeatedDayAll').prop('checked', true);\n      }\n\n      $('#priority').val(unit.priority);\n\n      $('input[name=advancePayment]').prop({ disabled: true, checked: false });\n      $('input[name=advancePayment]').each(function (index, el) {\n        $(el).prop('checked', $(el).val() == unit.advancePayment ? true : false);\n      });\n\n      $('#cinemaPageDesc').val(unit.cinemaPageDesc);\n      $('#activityIcon').val(unit.activityIcon);\n      $('#timetablePageDesc').val(unit.timetablePageDesc);\n      $('#activityDesc').val(unit.activityDesc);\n      $('#activityLink').val(unit.activityLink);\n      $('#activityRuleDesc').val(unit.activityRuleDesc);\n\n      //计划\n      if (unit.planId != '' && unit.planId != null && unit.planId != undefined) {\n        setPlan(unit.planId);\n      } else {\n        setPlan(false);\n      }\n\n      if (unitId) {\n        $('#planId').prop('disabled', true);\n      }\n\n      //成本中心\n      if (unit.budgetSourceId != '' && unit.budgetSourceId != null && unit.budgetSourceId != undefined) {\n        setBudgetSource(unit.budgetSourceId);\n        $('#level,#budgetSource').prop('disabled', true);\n      } else {\n        setBudgetSource(false);\n      }\n\n      //万达票类\n      if (unit.wandaTicketId != '' && unit.wandaTicketId != null && unit.wandaTicketId != undefined) {\n        setWandaTicket(unit.wandaTicketId);\n      } else {\n        setWandaTicket(false);\n      }\n\n      if (unitId) {\n        $('#wandaTicketId').prop('disabled', true);\n      }\n\n      //活动形式\n      $('#activityPattern option').eq(unit.activityPattern - 1).prop('selected', true);\n      var html = '';\n      var index = 0;\n      _(unit.activityPatternList).forEach(function (pattern) {\n        html += '<tr>';\n        html += '<td><input type=\"text\" class=\"amount\" required placeholder=\"必填\" data-parsley-pattern=\"^[1-9]{1}\\\\d*.{1}\\\\d{1,2}$|^[1-9]{1}\\\\d*$|^[0].{1}\\\\d{1,2}$\" value=\"' + pattern.amount + '\"></td>';\n        html += '<td><input type=\"text\" class=\"lowerBound parsley-range\" placeholder=\"不限\" data-parsley-pattern=\"^[1-9]{1}\\\\d*.{1}\\\\d{1,2}$|^[1-9]{1}\\\\d*$|^[0].{1}\\\\d{1,2}$\" data-parsley-ur=\"' + index + '\" value=\"' + pattern.lowerBound + '\"></td>';\n        html += '<td><input type=\"text\" class=\"upperBound parsley-range\" placeholder=\"不限\" data-parsley-pattern=\"^[1-9]{1}\\\\d*.{1}\\\\d{1,2}$|^[1-9]{1}\\\\d*$|^[0].{1}\\\\d{1,2}$\" data-parsley-ur=\"' + index + '\" value=\"' + pattern.upperBound + '\"></td>';\n        html += '<td><button type=\"button\" class=\"btn btn-xs btn-default btn-type-delete\">删除</button></td></tr>';\n        index++;\n      });\n\n      $('#typeTable tbody').html(html);\n      setPattern(unit.activityPattern);\n\n      //活动预算\n      var previewHtml = '';\n      var totalAmount = ~~unit.totalAmount == 0 ? '不限' : unit.totalAmount;\n      var totalTicket = ~~unit.totalTicket == 0 ? '不限' : unit.totalTicket;\n      previewHtml += '总金额预算：' + totalAmount + '；';\n      previewHtml += '总出票预算：' + totalTicket + '；';\n      _(unit.dailyBudgetList).forEach(function (daily) {\n        previewHtml += '<p>' + daily.startDate + ' ~ ' + daily.endDate + '，日金额预算：' + (daily.dailyAmount == '' ? '不限' : daily.dailyAmount) + '，日出票预算：' + (daily.dailyTicket == '' ? '不限' : daily.dailyTicket) + '；</p>';\n      });\n\n      $('#preview-budget').html(previewHtml);\n\n      //客群\n      if (unit.cusTypes != null) {\n        previewHtml = '';\n        if (unit.cusTypes.length == _cusTypes.length) {\n          previewHtml = '不限';\n        } else {\n          previewHtml = _cusTypes[unit.cusTypes[0] - 1];\n        }\n\n        $('#preview-custypes').html(previewHtml);\n      }\n\n      //特殊资格\n      previewHtml = unit.qualification != null && unit.qualification[0] == 'UD' ? '手机银行一网通登录用户' : '不限';\n      $('#preview-special').html(previewHtml);\n\n      //单户限购\n      previewHtml = '';\n      if (unit.saleLimit != null) {\n        previewHtml += ~~unit.saleLimit.dailyTicket != 0 ? '每日限购' + unit.saleLimit.dailyTicket + '张；' : '';\n        previewHtml += ~~unit.saleLimit.totalTicket != 0 ? '总共限购' + unit.saleLimit.totalTicket + '张；' : '';\n        previewHtml += ~~unit.saleLimit.dailyOrder != 0 ? '每日限购' + unit.saleLimit.dailyOrder + '笔；' : '';\n        previewHtml += ~~unit.saleLimit.totalOrder != 0 ? '总共限购' + unit.saleLimit.totalOrder + '笔；' : '';\n      } else {\n        previewHtml = '不限';\n      }\n\n      $('#preview-restriction').html(previewHtml);\n\n      //渠道\n      unit.channels != null && unit.channels.length > 0 ? setChannel(unit.channels) : setChannel(false);\n\n      //影片\n      unit.films != null && unit.films.length > 0 ? setMovie(unit.films) : setMovie(false);\n\n      //制式\n      var previewHtmlFilmType = unit.filmType.length == _filmType.length ? '影片制式：不限' : '影片制式：[' + unit.filmType.join('] [') + ']';\n      var previewHtmlScreenType = unit.screenType.length == _screenType.length ? '<br>屏幕规格：不限' : '<br>屏幕规格：[' + unit.screenType.join('] [') + ']';\n      var previewHtmlHallType = unit.hallType.length == _hallType.length ? '<br>特殊影厅：不限' : '<br>特殊影厅：[' + unit.hallType.join('] [') + ']';\n      $('#preview-dimen').html(previewHtmlFilmType + previewHtmlScreenType + previewHtmlHallType);\n\n      //影院\n      $('#preview-cinema').html(unit.cinemas != null && unit.cinemas.length > 0 ? '选择了 ' + unit.cinemas.length + ' 个影院' : '不限');\n\n      //场次\n      setTimeTable(unit.timetables);\n    } else {\n      alert('接口错误：' + res.meta.msg);\n    }\n  });\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/activity-unit-edit.js\n ** module id = 0\n ** module chunks = 6\n **/","'use strict;'\n\nrequire('cookie');\nvar common = {};\n\ncommon.API_HOST = window.location.protocol + '//' + window.location.host + '/MovieOps/';\n\ncommon.init = function (pageName) {\n  common.checkLogin();\n  common.showMenu(pageName);\n  common.setLoginName();\n\n  $.ajaxSetup({\n    error: function (jqXHR, textStatus, errorThrown) {\n      var errorMsg = jqXHR.status + '：未知错误！';\n      var redirectUrl = document.location.href;\n      switch (jqXHR.status){\n        case (500):\n          errorMsg = jqXHR.status + '：服务器无响应，请稍后再试！';\n        break;\n        case (401):\n          errorMsg = jqXHR.status + '：未登录或登陆超时，请尝试重新登陆！';\n          redirectUrl = 'login.html?logout';\n        break;\n        case (403):\n          errorMsg = jqXHR.status + '：没有权限，请尝试重新登陆！';\n          redirectUrl = 'login.html?logout';\n        break;\n        case (404):\n          errorMsg = jqXHR.status + '：服务器暂时无法访问，请稍后再试！';\n        break;\n        case (408):\n          errorMsg = jqXHR.status + '：请求超时，请稍后再试！';\n        break;\n        case (0):\n          errorMsg = jqXHR.status + '：貌似断网了！';\n        break;\n      }\n      $('<div class=\"modal fade\" data-keyboard=\"false\" data-backdrop=\"static\"><div class=\"modal-dialog\"><div class=\"modal-content\"><div class=\"modal-header\"><h4 class=\"modal-title\">错误提示</h4></div><div class=\"modal-body\"><p style=\"text-align:center;\">' + errorMsg + '</p></div><div class=\"modal-footer\"><a href=\"' + redirectUrl + '\" class=\"btn btn-primary\">确定</a></div></div></div></div>').appendTo('body').modal('show');\n      throw new Error('Abort, error ' + jqXHR.status);\n    },\n  });\n};\n\ncommon.showMenu = function (pageName) {\n  var allowMenus = sessionStorage.getItem('menuAuthority') != null ? sessionStorage.getItem('menuAuthority').split(',') : null;\n  if (pageName != undefined && pageName != '' && $('#menu-' + pageName).size() > 0) {\n    var menuId = '' + $('#menu-' + pageName).data('id');\n    if (allowMenus.indexOf(menuId) < 0) {\n      common.logout();\n      window.location.href = 'login.html';\n    }\n\n    $('#menu-' + pageName).addClass('active').closest('.panel-collapse').collapse('show');\n\n  }\n\n  var $menus = $('#menu .list-group-item');\n  $menus.each(function (index, el) {\n    menuId = '' + $(el).data('id');\n    if (allowMenus.indexOf(menuId) > -1) {\n      $(el).show();\n      $(el).closest('.panel').show();\n    }\n  });\n};\n\ncommon.checkLogin = function () {\n  if (sessionStorage.getItem('menuAuthority') == null || Cookies.get('Xtoken') == undefined) {\n    common.logout();\n    window.location.href = 'login.html';\n  }\n};\n\ncommon.setLoginName = function () {\n  var loginName = Cookies.get('name');\n  if (loginName != undefined && loginName != '') {\n    $('#loginName').text(loginName);\n  }\n};\n\ncommon.logout = function () {\n  Cookies.remove('Xtoken');\n  Cookies.remove('name');\n  sessionStorage.setItem('cityAuthority', '');\n  sessionStorage.setItem('channelAuthority', '');\n  sessionStorage.setItem('menuAuthority', '');\n};\n\ncommon.getDate = function (date) {\n  if (date == undefined || date == '') {\n    date = new Date();\n  }\n\n  var YYYY = date.getFullYear().toString();\n  var MM = (date.getMonth() + 1).toString();\n  var DD = date.getDate().toString();\n  MM = MM[1] ? MM : '0' + MM[0];\n  DD = DD[1] ? DD : '0' + DD[0];\n  return YYYY + '-' + MM + '-' + DD;\n};\n\ncommon.getUrlParam = function () {\n  var paramArr = {};\n  var query = window.location.search.substring(1);\n  var vars = query.split('&');\n  for (var i = 0; i < vars.length; i++) {\n    var pair = vars[i].split(/=(.+)?/);\n    if (typeof paramArr[pair[0]] === 'undefined') {\n      paramArr[pair[0]] = decodeURIComponent(pair[1]);\n    } else if (typeof paramArr[pair[0]] === 'string') {\n      var arr = [paramArr[pair[0]], decodeURIComponent(pair[1])];\n      paramArr[pair[0]] = arr;\n    } else {\n      paramArr[pair[0]].push(decodeURIComponent(pair[1]));\n    }\n  }\n\n  return paramArr;\n};\n\nmodule.exports = common;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/common/common.js\n ** module id = 1\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/","module.exports = global[\"Cookies\"] = require(\"-!/Users/liuge/Workspace/moviesys/bower_components/js-cookie/src/js.cookie.js\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/js-cookie/src/js.cookie.js\n ** module id = 2\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/","/*!\n * JavaScript Cookie v2.1.1\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\treturn (document.cookie = [\n\t\t\t\t\tkey, '=', value,\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\n\t\t\t\t\tattributes.secure ? '; secure' : ''\n\t\t\t\t].join(''));\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api(key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/js-cookie/src/js.cookie.js\n ** module id = 3\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/"],"sourceRoot":""}