{"version":3,"sources":["webpack:///webpack/bootstrap 253c517f38e56ead6c55","webpack:///./src/js/balance-out-detail.js","webpack:///./src/common/common.js","webpack:///./bower_components/js-cookie/src/js.cookie.js?76a1","webpack:///./bower_components/js-cookie/src/js.cookie.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;;AAEA,aAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH,EAAC;;AAED;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL,IAAG;AACH,6BAA4B,UAAU,+BAA+B,WAAW,aAAa,uOAAuO,aAAa,yCAAyC,8kBAA8kB,IAAI,EAAE,EAAE;AACh9B;AACA;;AAEA;AACA,EAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL,IAAG;AACH,6BAA4B,UAAU,+BAA+B,WAAW,aAAa,uOAAuO,aAAa,yCAAyC,8kBAA8kB,IAAI,EAAE,EAAE;AACh9B;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,6BAA4B;;AAE5B;AACA;;AAEA,QAAO,kCAAkC;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA,EAAC;;AAED;AACA;AACA,EAAC;;AAED;;AAEA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,EAAC;;AAED;;AAEA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,EAAC;;AAED;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAa,qCAAqC;AAClD,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL,IAAG;AACH,8BAA6B,WAAW,iCAAiC,YAAY,uBAAuB,qWAAqW,GAAG,qWAAqW,gBAAgB,0rBAA0rB,EAAE,EAAE;AACvgD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,EAAC;;AAED;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;AACb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,sBAAqB,kBAAkB;AACvC;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;;;;;;;;;;ACnjBA,aAAY;;AAEZ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yPAAwP;AACxP;AACA,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;ACzHA,2G;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,GAAE;AACF;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA,SAAQ,sBAAsB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAc;AACd;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,8BAA6B;AAC7B,8BAA6B;AAC7B,8BAA6B;AAC7B,4BAA2B;AAC3B;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,4DAA2D;AAC3D,8BAA6B,EAAE;AAC/B;;AAEA,UAAS,oBAAoB;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;;AAEA;AACA;;AAEA,4BAA2B;AAC3B,EAAC","file":"balance-out-detail.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Users/liuge/Workspace/moviesys/dist/js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 253c517f38e56ead6c55\n **/","/*\n\t出货对账明细\n  Ge Liu\n */\n\n'use strict;'\nvar common = require('common');\n\nvar _channels = {};\nvar _cities = [];\nvar _choosed = [];\nvar _movies = {};\nvar _pageIndex = 1;\nvar _pageSize = 10;\nvar _pageTotal = 0;\nvar _querying = false;\nvar searchCache = {};\nvar useCache = false;\nvar _submitting = false;\n\n// 如果当前查询是从汇总页的选中记录查询\nvar _queryingFromSelectedSummary = false;\n\nvar _selectedSummary = {};\n\nvar _DEBUG = false;\n\n$(function() {\n\n\tcommon.init('balance-out-detail');\n\n\t$('#search_startTime').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var startDate = new Date(ev.date.valueOf());\n    startDate.setDate(startDate.getDate(new Date(ev.date.valueOf())));\n    $('#search_endTime').datetimepicker('setStartDate', startDate);\n  });\n\n  $('#search_endTime').datetimepicker({\n    format: 'yyyy-mm-dd',\n    language: 'zh-CN',\n    minView: 2,\n    todayHighlight: true,\n    autoclose: true,\n  }).on('changeDate', function (ev) {\n    var FromEndDate = new Date(ev.date.valueOf());\n    FromEndDate.setDate(FromEndDate.getDate(new Date(ev.date.valueOf())));\n    $('#search_startTime').datetimepicker('setEndDate', FromEndDate);\n  });\n});\n\n$('#formSearch').parsley();\n\n// handle search form\n$('#formSearch').on('click', 'button[type=submit]', function (event) {\n  event.preventDefault();\n\n  _pageIndex = 1;\n  useCache = false;\n  _queryingFromSelectedSummary = false;\n  $('#formSearch').trigger('submit');\n});\n\n$('#formSearch').on('submit', function (e) {\n  e.preventDefault();\n\n  if (!useCache) {\n    if (!$('#formSearch').parsley().isValid()) {\n      return false;\n    }\n  }\n\n  var sendData = {\n  \tdateType: $('#search_dateType').val(),\n    startTime: $('#search_startTime').val(),\n    endTime: $('#search_endTime').val(),\n    merchantName: $('#search_merchantName').val(),\n    merchantNo: $('#search_merchantNo').val(),\n    shipmentStatus: $('#search_shipmentStatus').val(),\n    bizType: $('#search_bizType').val(),\n    partner: $('#search_partner').val(),\n    acquiringReconciliationStatus: $('#search_acquiringReconciliationStatus').val(),\n    reconciliationStatus: $('#search_reconciliationStatus').val(),\n    reason: $('#search_reson').val(),\n    discountType: $('#search_discountType').val(),\n    discountName: $('#search_discountName').val(),\n    bizOrderNo: $('#search_bizOrderNo').val(),\n    thdOrderNo: $('#search_thdOrderNo').val(),\n    checkStatus: $('#search_checkStatus').val(),\n    pageSize: _pageSize,\n  };\n  if (!!_querying) {\n    return false;\n  }\n\n  _querying = true;\n  if (useCache) {\n    sendData = searchCache;\n  } else {\n    searchCache = sendData;\n  }\n\n  sendData.pageIndex = _pageIndex;\n\n  if (!_DEBUG) {\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/infoList',\n      type: 'GET',\n      dataType: 'json',\n      data: sendData,\n    })\n    .done(function (res) {\n      handleData(res);\n    });\n  } else {\n    var res = $.parseJSON('{ \"meta\": { \"result\": \"1\", \"msg\": \"操作成功\" }, \"data\": { \"summary\": { \"count\": \"订单总数\", \"totalTicketCount\": \"出票张数\", \"totalTiketAmount\": \" 票价 \", \"totalReturnFee\":\"退票手续费\", \"totalServiceAmount\": \"总服务费\", \"totalSubsidyAmountO2o\": \"补贴总金额\", \"totalO2oReceivableAmount\": \"应收总金额\", \"totalBankAmount\": \"实际收到总金额\" }, \"detail\": { \"recordCount\": \"42\", \"recordDetail\": [ { \"receivablePoint\": \"积分\", \"bizType\": \"业务类型\", \"orderNo\": \"订单号\", \"countNum\": \"票数\", \"reconciliationDate\": \"对账日期\", \"thdSerialNo\":\"收单方订单号\", \"costCenter\": \"成本中心\", \"externalId\": \"支付流水\", \"o2oReceivableAmount\": \"应收金额\", \"subsidyType\": \"补贴方式\", \"chargeMerchant\":\"1\", \"subsidyAmountO2o\": \"补贴金额\", \"discountName\": \"活动/优惠方式名称\", \"bankAmount\":\"实收金额\", \"returnFee\":\"退票手续费\", \"payAmount\": \"支付金额\", \"serviceAmount\": \"服务费\", \"ticketAmount\":\"交易金额\", \"reconciliationStatus\":\"1\", \"createTime\": \"支付时间(交易)\", \"discountType\": \"优惠方式\", \"id\": 1934, \"payStatus\": \"1\", \"chargeMerchantNo\": \"商户号\", \"partner\":\"退款承债方\", \"reason\":\"1\" } ] } } }');\n    handleData(res);\n  }\n\n  return false;\n});\n\nfunction queryFromSelectedSummary() {\n\n  _selectedSummary.pageIndex = _pageIndex;\n  var url = common.API_HOST + 'settlement/shipmentInfo/listSummaryDetail?' + serializeParam(_selectedSummary);\n\n  if (!_DEBUG) {\n    $.ajax({\n      url: url,\n      type: 'GET',\n      dataType: 'json',\n    })\n    .done(function (res) {\n      handleData(res);\n    });\n  } else {\n    var res = $.parseJSON('{ \"meta\": { \"result\": \"1\", \"msg\": \"操作成功\" }, \"data\": { \"summary\": { \"count\": \"订单总数\", \"totalTicketCount\": \"出票张数\", \"totalTiketAmount\": \" 票价 \", \"totalReturnFee\":\"退票手续费\", \"totalServiceAmount\": \"总服务费\", \"totalSubsidyAmountO2o\": \"补贴总金额\", \"totalO2oReceivableAmount\": \"应收总金额\", \"totalBankAmount\": \"实际收到总金额\" }, \"detail\": { \"recordCount\": \"42\", \"recordDetail\": [ { \"receivablePoint\": \"积分\", \"bizType\": \"业务类型\", \"orderNo\": \"订单号\", \"countNum\": \"票数\", \"reconciliationDate\": \"对账日期\", \"thdSerialNo\":\"收单方订单号\", \"costCenter\": \"成本中心\", \"externalId\": \"支付流水\", \"o2oReceivableAmount\": \"应收金额\", \"subsidyType\": \"补贴方式\", \"chargeMerchant\":\"1\", \"subsidyAmountO2o\": \"补贴金额\", \"discountName\": \"活动/优惠方式名称\", \"bankAmount\":\"实收金额\", \"returnFee\":\"退票手续费\", \"payAmount\": \"支付金额\", \"serviceAmount\": \"服务费\", \"ticketAmount\":\"交易金额\", \"reconciliationStatus\":\"1\", \"createTime\": \"支付时间(交易)\", \"discountType\": \"优惠方式\", \"id\": 1934, \"payStatus\": \"1\", \"chargeMerchantNo\": \"商户号\", \"partner\":\"退款承债方\", \"reason\":\"1\" } ] } } }');\n    handleData(res);\n  }\n}\n\nfunction handlePresetQuery() {\n\n  var sessionParam = sessionStorage.param;\n  if (sessionParam) {\n    var passedParam = JSON.parse(sessionParam);\n\n    if (passedParam) {\n      // 从汇总页  查看选中明细\n      if (passedParam.type == 1) {\n        var parameters = passedParam.param;\n\n        _pageIndex = 1;\n        _selectedSummary = {'shipmentInfoFormCollection': parameters, 'pageSize': _pageSize};\n\n        _queryingFromSelectedSummary = true;\n        queryFromSelectedSummary();\n\n      } else if (passedParam.type == 0) { // 从汇总页  查看所有明细\n        var parameters = passedParam.param;\n\n        $('#search_dateType').val(parameters.dateType);\n        $('#search_startTime').val(parameters.startTime);\n        $('#search_endTime').val(parameters.endTime);\n        $('#search_merchantName').val(parameters.merchantName);\n        $('#search_merchantNo').val(parameters.MerchantNo);\n        $('#search_shipmentStatus').val(parameters.shipmentStatus);\n        $('#search_bizType').val(parameters.bizType);\n\n        _pageIndex = 1;\n        useCache = false;\n        $('#formSearch').trigger('submit');\n      }\n      sessionStorage.removeItem('param');\n    }\n  }\n}\n\nhandlePresetQuery();\n\nfunction handleData(res) {\n\t_querying = false;\n\n\tif (~res.meta.result) {\n\t\tif (res.data == null || res.data.detail.count < 1) {\n      var errorMsg = res.meta.msg;\n      $('#dataTable tbody').html('<tr><td colspan=\"30\" align=\"center\">' + errorMsg + '</td></tr>');\n      $('#summaryTable tbody').html('<tr><td colspan=\"30\" align=\"center\">' + errorMsg + '</td></tr>');\n      $('#pager').html('');\n\t\t} else {\n\t\t\tvar totalRecord = res.data.detail.count;\n      var record = res.data.detail.records;\n\n      _pageTotal = Math.ceil(totalRecord / _pageSize);\n      setPager(totalRecord, _pageIndex, record.length, _pageTotal);\n\n      _(record).forEach(function(item) {\n        item.bizType = parseBizType(item.bizType);\n        item.payStatus = parsePayStatus(item.payStatus);\n        item.partner = parsePartner(item.partner);\n        item.acquiringReconciliationStatus = parseReconciliationStatus(item.acquiringReconciliationStatus);\n        item.subsidyType = parseSubsidyType(item.subsidyType);\n        item.reconciliationStatus = parseReconciliationStatus(item.reconciliationStatus);\n        item.reason = parseReason(item.reason);\n        item.discountType = parseDiscountType(item.discountType);\n        item.shipmentStatus = parseShipmentStatus(item.shipmentStatus);\n        item.checkStatus = parseCheckStatus(item.checkStatus);\n      });\n\n      if (!_queryingFromSelectedSummary) {\n        useCache = true;\n      }\n\n      setTableData(record);\n\n      setSummaryTableData(res.data.summary);\n\t\t}\n\t}\n}\n\nfunction setTableData(rows) {\n  var data = { rows: rows };\n  var template = $('#table-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template, data);\n  $('#dataTable tbody').html(html);\n}\n\nfunction setSummaryTableData(data) {\n\tvar template = $('#summary-table-template').html();\n\tMustache.parse(template);\n\tvar html = Mustache.render(template, data);\n\t$('#summaryTable tbody').html(html);\n}\n\n\nfunction setPager(total, pageIndex, rowsSize, pageTotal) {\n  var data = { total: total, pageIndex: pageIndex, rowsSize: rowsSize, pageTotal: pageTotal };\n  var template = $('#pager-template').html();\n  Mustache.parse(template);\n  var html = Mustache.render(template, data);\n  $('#pager').html(html);\n}\n\n$('#pager').on('click', '.prev,.next', function (e) {\n  e.preventDefault();\n  if ($(this).hasClass('prev')) {\n    if (_pageIndex <= 1) {\n      _pageIndex = 1;\n      alert('已经是第一页！');\n      return false;\n    }\n\n    _pageIndex--;\n  } else {\n    if (_pageIndex >= _pageTotal) {\n      _pageIndex = _pageTotal;\n      alert('已经是最后一页！');\n      return false;\n    }\n\n    _pageIndex++;\n  }\n\n  if (_queryingFromSelectedSummary) {\n    queryFromSelectedSummary();\n  } else {\n    $('#formSearch').trigger('submit');\n  }\n  return false;\n});\n\n$('#pager').on('click', '#btn-pager', function (e) {\n  e.preventDefault();\n  if ('' == $('#pageNo').val()) {\n    return false;\n  }\n\n  var pageNo = parseInt($('#pageNo').val());\n  if (NaN == pageNo || pageNo < 1 || pageNo > _pageTotal) {\n    alert('要跳转的页码超过了范围！');\n    return false;\n  }\n\n  _pageIndex = pageNo;\n\n  if (_queryingFromSelectedSummary) {\n    queryFromSelectedSummary();\n  } else {\n    $('#formSearch').trigger('submit');\n  }\n\n  return false;\n});\n\n$('.btn-reset').click(function(e) {\n $('#formSearch :input:not(:button)').val('');\n});\n\n$('.btn-export-all').click(function(e) {\n\n  e.preventDefault();\n\n  if (_queryingFromSelectedSummary) {\n    var param = {'shipmentInfoFormCollection' : _selectedSummary.shipmentInfoFormCollection};\n\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/exportSummaryDetail' + serializeParam(param),\n      type: 'GET',\n      dataType: 'json',\n    })\n    .done(function(res) {\n      if (res.meta.result == 0) {\n        alert(res.meta.msg);\n      } else {\n        window.location.href = common.API_HOST + 'settlement/merchantAttachment/downLoad?fileUrl=' + res.data.fileUrl;\n      }\n    });\n  } else {\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/infoListExport', \n      type: 'GET',\n      dataType: 'json',\n      data: searchCache,\n    })\n    .done(function (res) {\n      if (res.meta.result == 0) {\n        alert(res.meta.msg);\n      } else {\n        window.location.href = common.API_HOST + 'settlement/merchantAttachment/downLoad?fileUrl=' + res.data.fileUrl;\n      }\n    });\n  }\n});\n\n$('.complete-commit').click(function(e) {\n\n  e.preventDefault();\n\n  if (_queryingFromSelectedSummary) {\n    var param = {'shipmentInfoFormCollection' : _selectedSummary.shipmentInfoFormCollection};\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/listSummaryDetailUpdate',\n      type: 'POST',\n      dataType: 'json',\n      data: param\n    })\n    .done(function(res) {\n      if (res.meta.result == 0) {\n        alert(res.meta.msg);\n      } else {\n        alert(res.meta.msg);\n      }\n    });\n  } else {\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/updateInfoList',\n      type: 'POST',\n      dataType: 'json',\n      data: searchCache,\n    })\n    .done(function (res) {\n      if (res.meta.result == 0) {\n        alert(res.meta.msg);\n      } else {\n        alert(res.meta.msg);\n      }\n    });\n  }\n});\n\n$('#dataTable').on('click', '.btn-edit', function (e) {\n\n  e.preventDefault();\n\n  if (!_DEBUG) {\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/onlyShipmentInfo',\n      type: 'GET',\n      data: {id: $(this).closest('tr').data('id')},\n    })\n    .done(function(res) {\n      if (res.meta.result == 0) {\n        alert('查询数据失败!');\n        return false;\n      }\n      var data = res.data;\n      data.detail = data.onlyShipmentInfo;\n      var detail = data.detail;\n      detail.payTool = parsePayTool(detail.payTool);\n      detail.payStatus = parsePayStatus(detail.payStatus);\n      detail.bizType = parseBizType(detail.bizType);\n      detail.chargeMerchant = parseMerchant(detail.chargeMerchant);\n      detail.discountType = parseDiscountType(detail.discountType);\n      detail.acquiringReconciliationStatus = parseReconciliationStatus(detail.acquiringReconciliationStatus);\n\n      var operate = data.operate;\n\n      operate.forEach(function(obj) {\n        obj.subsidyType = parseSubsidyType(obj.subsidyType);\n        obj.partner = parsePartner(obj.partner);\n        obj.reconciliationStatus = parseReconciliationStatus(obj.reconciliationStatus);\n        obj.reason = parseReason(obj.reason);\n      });\n\n      var template = $('#detail-template').html();\n      Mustache.parse(template);\n      var html = Mustache.render(template, data);\n      $('#popup-detail .modal-body').html(html);\n\n      $('#popup-detail').modal('show');\n\n      $('#subsidyType option[value=\"' + detail.subsidyType + '\"]').prop('selected', true);\n      $('#partner option[value=\"' + detail.partner + '\"]').prop('selected', true);\n      $('#shipmentStatus option[value=\"' + detail.shipmentStatus + '\"]').prop('selected', true);\n      $('#reconciliationStatus option[value=\"' + detail.reconciliationStatus + '\"]').prop('selected', true);\n      $('#reason option[value=\"' + detail.reason + '\"]').prop('selected', true);\n\n    });\n  } else {\n    var data = $.parseJSON('{ \"meta\" : { \"result\" : \"1\", \"msg\" : \"操作成功\" }, \"data\" : { \"operateRecords\" : [ { \"bizType\" : 1, \"orderNo\" : \"738289474424934400\", \"o2oReceivableAmount\" : 12, \"operateTime\" : \"2016-06-23 15:42:18\", \"operatorName\" : \"徐慧\", \"subsidyAmountO2o\" : 4750, \"discountName\" : \"买2减1\", \"ticketAmount\" : 4750, \"chargeMerchant\" : 1, \"serviceAmount\" : 0, \"partner\" : \"3\", \"reconciliationStatus\" : 4, \"returnFee\" : 1, \"discountType\" : 1, \"payStatus\" : 4 }, { \"bizType\" : 1, \"orderNo\" : \"738289474424934400\", \"o2oReceivableAmount\" : 12, \"operateTime\" : \"2016-06-23 11:50:51\", \"operatorName\" : \"李瑾\", \"subsidyAmountO2o\" : 4750, \"discountName\" : \"买2减1\", \"ticketAmount\" : 4750, \"chargeMerchant\" : 1, \"serviceAmount\" : 0, \"partner\" : \"3\", \"reconciliationStatus\" : 4, \"returnFee\" : 1, \"discountType\" : 1, \"payStatus\" : 4 } ], \"detail\" : { \"reason\" : 1, \"receivablePoint\" : 0, \"bizType\" : 1, \"reconciliationDate\" : 1466733543000, \"subsidyType\" : 1, \"bankAmount\" : 1, \"checkStatus\" : 1, \"discountName\" : \"买2减1\", \"ticketAmount\" : 1, \"payAmount\" : 4700, \"serviceAmount\" : 0, \"discountType\" : 1, \"id\" : 2585, \"thdSerialNo\" : \"1223\", \"orderNo\" : \"738284476651671552\", \"countNum\" : 1, \"costCenter\" : \"卡中心总部\", \"o2oReceivableAmount\" : 4700, \"externalId\" : 857, \"updateTime\" : 1466738155000, \"version\" : 0, \"subsidyAmountO2o\" : 0, \"chargeMerchant\" : 1, \"partner\" : \"1\", \"reconciliationStatus\" : 4, \"createTime\" : 1464796800000, \"returnFee\" : 12, \"chargeMerchantNo\" : \"738284476651671552\", \"payStatus\" : 1, \"chargeMerchantNo\" : \"308010700103175\" } } }');\n    data = data.data;\n    var detail = data.detail;\n    detail.payTool = parsePayTool(detail.payTool);\n    detail.payStatus = parsePayStatus(detail.payStatus);\n    detail.bizType = parseBizType(detail.bizType);\n    detail.chargeMerchant = parseMerchant(detail.chargeMerchant);\n    var template = $('#detail-template').html();\n    Mustache.parse(template);\n    var html = Mustache.render(template, data);\n    $('#popup-detail .modal-body').html(html);\n\n    $('#popup-detail').modal('show');\n  }\n});\n\n// 修改提交\n$('body').on('click', '.edit-submit', function(e) {\n  e.preventDefault();\n\n  var param = {\n    id: $(this).data('id'),\n    oldVersion: $(this).data('version'),\n    merchantName: $('#merchantName').val(),\n    merchantId: $('#merchantNo').val(),\n    settleAmount: $('#settleAmount').val(),\n    subsidyAmountO2o: $('#subsidyAmountO2o').val(),\n    subsidyType: $('#subsidyType').val(),\n    acceptanceAppropriation: $('#acceptanceAppropriation').val(),\n    returnFee: $('#returnFee').val(),\n    partner: $('#returnFee').val(),\n    finalSettleAmount: $('#finalSettleAmount').val(),\n    reconciliationStatus: $('#reconciliationStatus').val(),\n    shipmentStatus: $('#shipmentStatus').val(),\n    reason: $('#reason').val()\n  };\n\n  if (!_DEBUG) {\n    $.ajax({\n      url: common.API_HOST + 'settlement/shipmentInfo/updateOnlyShipmentInfo',\n      data: param,\n    }).done(function(res) {\n      if (res.meta.result != 1) {\n        // TODO: submit failed\n      } else {\n        alert('提交成功');\n      }\n    });\n  }\n});\n\n/****************************************** Utilities Method **********************************************/\n\nfunction parseMerchant(merchant) {\n  var map = {'1' : '卡中心', '2' : '总行'};\n  return map[merchant];\n}\n\nfunction parsePayStatus(payStatus) {\n  var map = {'1' : '待支付', '2' : '支付成功', '3' : '支付失败', '4' : '退款中', '5' : '退款成功', '6' : '退款失败'};\n  return map[payStatus];\n}\n\nfunction parseReconciliationStatus(status) {\n  var map = {'1' : '未对账', '2' : '对账不一致', '3' : '对账成功', '4' : '确认'};\n  return map[status];\n}\n\nfunction parseReason(reason) {\n  var map = {'1' : '我方缺失', '2' : '对方缺失', '3' : '状态错误', '4' : '金额不符'};\n  return map[reason];\n}\n\nfunction parsePayTool(payTool) {\n  var map = {'1' : '掌上生活', '2' : '手机银行'};\n  return map[payTool];\n}\n\nfunction parseBizType(bizType) {\n  var map = {'1' : '影票', '2' : '手续费'};\n  return map[bizType];\n}\n\n// not used\nfunction parseSubsidyType(type) {\n  var map = {'1' : '预付', '2' : '后付'};\n  return map[type];\n}\n\nfunction parseDiscountType(type) {\n  var map = {'1' : '活动', '2' : '优惠券'};\n\n  return map[type];\n}\n\nfunction parsePartner(partner) {\n  var map = {'1' : 'O2O', '2' : 'TP方', '3' : '渠道方'};\n  return map[partner];\n}\n\nfunction parseShipmentStatus(status) {\n  var map = {'1' : '未出货(初始化状态)', '2' : '出货成功', '3' : '出货失败', '4' : '出货中', '5' : '待定', '6' : '待定', '7' : '退货成功', '8' : '退货失败'};\n\n  return map[status];\n}\n\nfunction parseCheckStatus(status) {\n  var map = {'1' : '未修改', '2' : '待审核', '3' : '审核完成', '4' : '驳回'};\n\n  return map[status];\n}\n\n\n// Caution: only array is concerned in this function\nfunction serializeParam(param) {\n\n  var queryString = '';\n\n  for (var key in param) {\n    var value = param[key];\n\n    if (value instanceof Array) {\n      for (var i = 0; i < value.length; ++i) {\n        var obj = value[i];\n\n        for (var innerKey in obj) {\n          queryString += key + '[' + i + '].' + innerKey + '=' + encodeURIComponent(obj[innerKey]) + '&';\n        }\n      }\n    } else {\n      queryString += key + '=' + encodeURIComponent(value) + '&';\n    }\n  }\n\n  queryString = queryString.slice(0, queryString.length - 1);\n\n  return queryString;\n}\n\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/js/balance-out-detail.js\n ** module id = 0\n ** module chunks = 10\n **/","'use strict;'\n\nrequire('cookie');\nvar common = {};\n\ncommon.API_HOST = window.location.protocol + '//' + window.location.host + '/MovieOps/';\n\ncommon.init = function (pageName) {\n  common.checkLogin();\n  common.showMenu(pageName);\n  common.setLoginName();\n\n  $.ajaxSetup({\n    error: function (jqXHR, textStatus, errorThrown) {\n      var errorMsg = jqXHR.status + '：未知错误！';\n      var redirectUrl = document.location.href;\n      switch (jqXHR.status){\n        case (500):\n          errorMsg = jqXHR.status + '：服务器无响应，请稍后再试！';\n        break;\n        case (401):\n          errorMsg = jqXHR.status + '：未登录或登陆超时，请尝试重新登陆！';\n          redirectUrl = 'login.html?logout';\n        break;\n        case (403):\n          errorMsg = jqXHR.status + '：没有权限，请尝试重新登陆！';\n          redirectUrl = 'login.html?logout';\n        break;\n        case (404):\n          errorMsg = jqXHR.status + '：服务器暂时无法访问，请稍后再试！';\n        break;\n        case (408):\n          errorMsg = jqXHR.status + '：请求超时，请稍后再试！';\n        break;\n        case (0):\n          errorMsg = jqXHR.status + '：貌似断网了！';\n        break;\n      }\n      $('<div class=\"modal fade\" data-keyboard=\"false\" data-backdrop=\"static\"><div class=\"modal-dialog\"><div class=\"modal-content\"><div class=\"modal-header\"><h4 class=\"modal-title\">错误提示</h4></div><div class=\"modal-body\"><p style=\"text-align:center;\">' + errorMsg + '</p></div><div class=\"modal-footer\"><a href=\"' + redirectUrl + '\" class=\"btn btn-primary\">确定</a></div></div></div></div>').appendTo('body').modal('show');\n      throw new Error('Abort, error ' + jqXHR.status);\n    },\n  });\n};\n\ncommon.showMenu = function (pageName) {\n  var allowMenus = sessionStorage.getItem('menuAuthority') != null ? sessionStorage.getItem('menuAuthority').split(',') : null;\n  if (pageName != undefined && pageName != '' && $('#menu-' + pageName).size() > 0) {\n    var menuId = '' + $('#menu-' + pageName).data('id');\n    if (allowMenus.indexOf(menuId) < 0) {\n      common.logout();\n      window.location.href = 'login.html';\n    }\n\n    $('#menu-' + pageName).addClass('active').closest('.panel-collapse').collapse('show');\n\n  }\n\n  var $menus = $('#menu .list-group-item');\n  $menus.each(function (index, el) {\n    menuId = '' + $(el).data('id');\n    if (allowMenus.indexOf(menuId) > -1) {\n      $(el).show();\n      $(el).closest('.panel').show();\n    }\n  });\n};\n\ncommon.checkLogin = function () {\n  if (sessionStorage.getItem('menuAuthority') == null || Cookies.get('Xtoken') == undefined) {\n    common.logout();\n    window.location.href = 'login.html';\n  }\n};\n\ncommon.setLoginName = function () {\n  var loginName = Cookies.get('name');\n  if (loginName != undefined && loginName != '') {\n    $('#loginName').text(loginName);\n  }\n};\n\ncommon.logout = function () {\n  Cookies.remove('Xtoken');\n  Cookies.remove('name');\n  sessionStorage.setItem('cityAuthority', '');\n  sessionStorage.setItem('channelAuthority', '');\n  sessionStorage.setItem('menuAuthority', '');\n};\n\ncommon.getDate = function (date) {\n  if (date == undefined || date == '') {\n    date = new Date();\n  }\n\n  var YYYY = date.getFullYear().toString();\n  var MM = (date.getMonth() + 1).toString();\n  var DD = date.getDate().toString();\n  MM = MM[1] ? MM : '0' + MM[0];\n  DD = DD[1] ? DD : '0' + DD[0];\n  return YYYY + '-' + MM + '-' + DD;\n};\n\ncommon.getUrlParam = function () {\n  var paramArr = {};\n  var query = window.location.search.substring(1);\n  var vars = query.split('&');\n  for (var i = 0; i < vars.length; i++) {\n    var pair = vars[i].split(/=(.+)?/);\n    if (typeof paramArr[pair[0]] === 'undefined') {\n      paramArr[pair[0]] = decodeURIComponent(pair[1]);\n    } else if (typeof paramArr[pair[0]] === 'string') {\n      var arr = [paramArr[pair[0]], decodeURIComponent(pair[1])];\n      paramArr[pair[0]] = arr;\n    } else {\n      paramArr[pair[0]].push(decodeURIComponent(pair[1]));\n    }\n  }\n\n  return paramArr;\n};\n\nmodule.exports = common;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/common/common.js\n ** module id = 1\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/","module.exports = global[\"Cookies\"] = require(\"-!/Users/liuge/Workspace/moviesys/bower_components/js-cookie/src/js.cookie.js\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/js-cookie/src/js.cookie.js\n ** module id = 2\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/","/*!\n * JavaScript Cookie v2.1.1\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\treturn (document.cookie = [\n\t\t\t\t\tkey, '=', value,\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\n\t\t\t\t\tattributes.secure ? '; secure' : ''\n\t\t\t\t].join(''));\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api(key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./bower_components/js-cookie/src/js.cookie.js\n ** module id = 3\n ** module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46\n **/"],"sourceRoot":""}