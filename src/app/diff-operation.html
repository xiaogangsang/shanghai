<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<link rel="icon" href="images/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>差异处理</title>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/css-hud.css">
</head>
<body>

	@@include('component/header.tpl')

	<div class="container-fluid">

		<div class="row">

			@@include('component/sidebar.tpl')

			<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

				<ol class="breadcrumb">
					<li>差异管理</li>
					<li class="active">差异处理</li>
				</ol>

				<form id="formSearch" class="search-area clearfix">
					<div class="col-sm-8">
						<div class="form-group col-sm-6">
							<div class="input-group">
								<div class="input-group-addon">结算日期</div>
								<input type="text" class="form-control" id="search_startTime" readonly data-parsley-pattern="[0-9]{4}?-[0-9]{2}?-[0-9]{2}?">
							</div>
						</div>
						<div class="form-group col-sm-6">
							<div class="input-group">
								<div class="input-group-addon">至</div>
								<input type="text" class="form-control" id="search_endTime" readonly data-parsley-pattern="[0-9]{4}?-[0-9]{2}?-[0-9]{2}?">
							</div>
						</div>
						<div class="form-group col-sm-6">
							<div class="input-group">
								<div class="input-group-addon">交易订单号</div>
								<input type="text" class="form-control" id="search_orderNo" data-parsley-pattern="[0-9]+" data-parsley-error-message="格式不正确，请输入数字">
							</div>
						</div>
						<div class="form-group col-sm-6">
							<div class="input-group">
								<div class="input-group-addon">对账一致</div>
								<select class="form-control" id="search_matched">
									<option value="1">是</option>
									<option value="2">否</option>
								</select>
							</div>
						</div>
					</div>
					<div class="col-sm-4">
							<button type="submit" class="btn btn-block btn-primary">查询</button>
					</div>

					<div class="col-sm-12">
						<div class="col-sm-3">
							<button type="button" class="btn btn-block btn-default" id="btn-export">导出</button>
						</div>
						<div class="col-sm-3">
							<button type="button" class="btn btn-block btn-default" id="btn-batch">批量生成差异</button>
						</div>
	 					<div class="col-sm-3">
							<button type="button" class="btn btn-block btn-default" id="btn-sync">同步出货对账状态</button>
						</div>
						<div class="col-sm-3">
							<button type="button" class="btn btn-block btn-default" data-toggle="modal" data-target="#popup-auto-diff">自动整理</button>
						</div>
					</div>
				</form>

				<div class="content-area">
					<div class="row" id="pager"></div>
					@@include('component/pager.tpl')

					<div class="table-responsive">
						<table class="table table-hover" id="dataTable">
							<thead>
								<tr>
									<th><input type="checkbox" class="multi-check-all"></th>
									<th>结算日期</th>
									<th>交易订单号</th>
									<th>销售结算价</th>
									<th>实收销售款</th>
									<th>退货结算价</th>
									<th>实退销售额</th>
									<th>常规活动</br>后付补贴金额</th>
									<th>支付活动</br>后付补贴金额</th>
									<th>服务费</th>
									<th>差异计算值</th>
									<th>差异拆分值</th>
									<th>对账一致</th>
									<th>操作</th>
								</tr>
							</thead>
							<tbody>
								<tr>
								  <td colspan="30" align="center">请点击“查询”按钮！</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>

			</div>
		</div>
	</div>

	<div class="modal fade" id="popup-auto-diff">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-lable="Close"><span aria-hidden="true">&times;</span></button>
					<h5 class="modal-title">启动自动整理</h5>
				</div>
				<div class="modal-body">
					<div class="container-fluid">
						<form id="formAutoDiff">
							<div class="row">
								<div class="form-group col-sm-6">
									<div class="input-group">
										<div class="input-group-addon">结算日期</div>
										<input type="text" class="form-control" id="auto_startTime" required data-parsley-pattern="[0-9]{4}?-[0-9]{2}?-[0-9]{2}?">
									</div>
								</div>
								<div class="form-group col-sm-6">
									<div class="input-group">
										<div class="input-group-addon">至</div>
										<input type="text" class="form-control" id="auto_endTime" required data-parsley-pattern="[0-9]{4}?-[0-9]{2}?-[0-9]{2}?">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-4 col-sm-offset-4">
									<button type="submit" class="form-control btn btn-primary">启动</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="popup-edit-diff">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-lable="Close"><span aria-hidden="true">&times;</span></button>
					<h5 class="modal-title">新增/编辑差异</h5>
				</div>
				<div class="modal-body">
					@@include('component/popup-diff-operation-edit.tpl')
				</div>
			</div>
		</div>
	</div>
	<script src="js/diff-operation-edit.js"></script>

	<div id="hud-overlay" style="display: none">
	  <div class="hud"><img src="images/loader.gif">
	    <p>计算中...</p>
	  </div>
	</div>

	<script id="table-template" type="text/x-tmpl-mustache">
	  {{#rows}}
	  <tr>
	    <td><input type="checkbox" class="multi-check"></td>
	    <!-- 结算日期 -->
	    <td>{{settleDate}}</td>
	    <!-- 交易订单号 -->
	    <td>{{orderNo}}</td>
	    <!-- 销售结算价 -->
	    <td>{{saleSettlePrice}}</td>
	    <!-- 实收销售款 -->
	    <td>{{bankAmountPay}}</td>
	    <!-- 退货结算价 -->
	    <td>{{refundSettlePrice}}</td>
	    <!-- 实退销售款 -->
	    <td>{{bankAmountRefund}}</td>
	    <!-- 常规活动后付补贴金额 -->
	    <td>{{budgetAmount}}</td>
	    <!-- 支付活动后付补贴金额 -->
	    <td>{{budgetAmountTrd}}</td>
	    <!-- 服务费 -->
	    <td>{{serviceFee}}</td>
	    <!-- 差异计算值 -->
	    <td>{{differAmount}}</td>
	    <!-- 差异拆分值 -->
	    <td>{{differSplitAmount}}</td>
	    <!-- 对账一致 -->
	    <td>{{matched}}</td>
	    <td><button class="btn btn-xs btn-default btn-edit">创建差异</button></td>
	  </tr>
	  {{/rows}}
	</script>

	<script src="js/vendor.js"></script>
	<script src="js/diff-operation.js"></script>
</body>
</html>